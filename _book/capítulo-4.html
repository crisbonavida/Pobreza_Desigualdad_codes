<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Capítulo 4 | Apéndices del Libro Pobreza y Desigualdad en R</title>
  <meta name="description" content="Nos propusimos trasncribir al lenguaje R y Python los apéndices del libro Pobreza y Desigualdad en América Latina de Gasparini, Cicowiez y Sosa Escudero que originalmente fueron escritos para Stata." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Capítulo 4 | Apéndices del Libro Pobreza y Desigualdad en R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/portada_libro_cover.png" />
  <meta property="og:description" content="Nos propusimos trasncribir al lenguaje R y Python los apéndices del libro Pobreza y Desigualdad en América Latina de Gasparini, Cicowiez y Sosa Escudero que originalmente fueron escritos para Stata." />
  <meta name="github-repo" content="crisbonavida/Pobreza_Desigualdad_codes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Capítulo 4 | Apéndices del Libro Pobreza y Desigualdad en R" />
  
  <meta name="twitter:description" content="Nos propusimos trasncribir al lenguaje R y Python los apéndices del libro Pobreza y Desigualdad en América Latina de Gasparini, Cicowiez y Sosa Escudero que originalmente fueron escritos para Stata." />
  <meta name="twitter:image" content="/portada_libro_cover.png" />

<meta name="author" content="Bonavida, Cristian - CEDLAS" />
<meta name="author" content="Laguinge, Luis - CEDLAS" />
<meta name="author" content="Varvasino, Joaquín - CEDLAS" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="capítulo-3.html"/>
<link rel="next" href="capítulo-5.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Una herramienta práctica para trabajar con datos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bienvenidos</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-este-proyecto"><i class="fa fa-check"></i>Sobre este Proyecto:</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#el-libro"><i class="fa fa-check"></i>El Libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cómo-aprovechar-este-material"><i class="fa fa-check"></i>Cómo aprovechar este material</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#qué-es-y-qué-no-es"><i class="fa fa-check"></i>Qué es y qué no es</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#qué-necesitamos-antes-de-arrancar"><i class="fa fa-check"></i>Qué necesitamos antes de arrancar</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="capítulo-2.html"><a href="capítulo-2.html"><i class="fa fa-check"></i><b>2</b> Capítulo 2</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-2.html"><a href="capítulo-2.html#set-inicial"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="2.1" data-path="capítulo-2.html"><a href="capítulo-2.html#introducción-ejemplo-brasil"><i class="fa fa-check"></i><b>2.1</b> Introducción: ejemplo Brasil</a></li>
<li class="chapter" data-level="2.2" data-path="capítulo-2.html"><a href="capítulo-2.html#histogramas"><i class="fa fa-check"></i><b>2.2</b> Histogramas</a></li>
<li class="chapter" data-level="2.3" data-path="capítulo-2.html"><a href="capítulo-2.html#función-de-distribución"><i class="fa fa-check"></i><b>2.3</b> Función de distribución</a></li>
<li class="chapter" data-level="2.4" data-path="capítulo-2.html"><a href="capítulo-2.html#pareto"><i class="fa fa-check"></i><b>2.4</b> Pareto</a></li>
<li class="chapter" data-level="2.5" data-path="capítulo-2.html"><a href="capítulo-2.html#box-plot"><i class="fa fa-check"></i><b>2.5</b> Box-plot</a></li>
<li class="chapter" data-level="2.6" data-path="capítulo-2.html"><a href="capítulo-2.html#curva-de-lorenz"><i class="fa fa-check"></i><b>2.6</b> Curva de Lorenz</a></li>
<li class="chapter" data-level="2.7" data-path="capítulo-2.html"><a href="capítulo-2.html#curva-generalizada-de-lorenz"><i class="fa fa-check"></i><b>2.7</b> Curva Generalizada de Lorenz</a></li>
<li class="chapter" data-level="2.8" data-path="capítulo-2.html"><a href="capítulo-2.html#cap-2.8"><i class="fa fa-check"></i><b>2.8</b> Curva de Incidencia</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="capítulo-3.html"><a href="capítulo-3.html"><i class="fa fa-check"></i><b>3</b> Capítulo 3</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-3.html"><a href="capítulo-3.html#set-inicial-1"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="3.1" data-path="capítulo-3.html"><a href="capítulo-3.html#cociente-de-cuantiles"><i class="fa fa-check"></i><b>3.1</b> Cociente de cuantiles</a></li>
<li class="chapter" data-level="3.2" data-path="capítulo-3.html"><a href="capítulo-3.html#cap-3.2"><i class="fa fa-check"></i><b>3.2</b> Replicar programa ratq51</a></li>
<li class="chapter" data-level="3.3" data-path="capítulo-3.html"><a href="capítulo-3.html#replicar-programa-gcuan"><i class="fa fa-check"></i><b>3.3</b> Replicar programa gcuan</a></li>
<li class="chapter" data-level="3.4" data-path="capítulo-3.html"><a href="capítulo-3.html#tamaño-de-los-hogares"><i class="fa fa-check"></i><b>3.4</b> Tamaño de los hogares</a></li>
<li class="chapter" data-level="3.5" data-path="capítulo-3.html"><a href="capítulo-3.html#la-distribución-intrahogar"><i class="fa fa-check"></i><b>3.5</b> La distribución intrahogar</a></li>
<li class="chapter" data-level="3.6" data-path="capítulo-3.html"><a href="capítulo-3.html#cap-3.6"><i class="fa fa-check"></i><b>3.6</b> Empleo de ponderadores</a></li>
<li class="chapter" data-level="3.7" data-path="capítulo-3.html"><a href="capítulo-3.html#diseño-muestral"><i class="fa fa-check"></i><b>3.7</b> Diseño muestraL</a></li>
<li class="chapter" data-level="3.8" data-path="capítulo-3.html"><a href="capítulo-3.html#fuentes-de-ingreso"><i class="fa fa-check"></i><b>3.8</b> Fuentes de ingreso</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="capítulo-4.html"><a href="capítulo-4.html"><i class="fa fa-check"></i><b>4</b> Capítulo 4</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-4.html"><a href="capítulo-4.html#set-inicial-2"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="4.1" data-path="capítulo-4.html"><a href="capítulo-4.html#indicador-fgt"><i class="fa fa-check"></i><b>4.1</b> Indicador FGT</a></li>
<li class="chapter" data-level="4.2" data-path="capítulo-4.html"><a href="capítulo-4.html#computar-fgt"><i class="fa fa-check"></i><b>4.2</b> Computar FGT</a></li>
<li class="chapter" data-level="4.3" data-path="capítulo-4.html"><a href="capítulo-4.html#pobreza-relativa"><i class="fa fa-check"></i><b>4.3</b> Pobreza relativa</a></li>
<li class="chapter" data-level="4.4" data-path="capítulo-4.html"><a href="capítulo-4.html#descompoisición-regional-de-la-pobreza"><i class="fa fa-check"></i><b>4.4</b> Descompoisición regional de la pobreza</a></li>
<li class="chapter" data-level="4.5" data-path="capítulo-4.html"><a href="capítulo-4.html#pobreza-según-consumo-e-ingreso"><i class="fa fa-check"></i><b>4.5</b> Pobreza según consumo e ingreso</a></li>
<li class="chapter" data-level="4.6" data-path="capítulo-4.html"><a href="capítulo-4.html#pobreza-por-edad"><i class="fa fa-check"></i><b>4.6</b> Pobreza por edad</a></li>
<li class="chapter" data-level="4.7" data-path="capítulo-4.html"><a href="capítulo-4.html#significatividad-estadistica"><i class="fa fa-check"></i><b>4.7</b> Significatividad estadistica</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="capítulo-5.html"><a href="capítulo-5.html"><i class="fa fa-check"></i><b>5</b> Capítulo 5</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-5.html"><a href="capítulo-5.html#set-inicial-3"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="5.1" data-path="capítulo-5.html"><a href="capítulo-5.html#pobreza-multidimensional"><i class="fa fa-check"></i><b>5.1</b> Pobreza Multidimensional</a></li>
<li class="chapter" data-level="5.2" data-path="capítulo-5.html"><a href="capítulo-5.html#indice-bourguignon-y-chakravarty-bc---pobreza-multidimensional"><i class="fa fa-check"></i><b>5.2</b> Indice Bourguignon y Chakravarty (BC) - Pobreza Multidimensional</a></li>
<li class="chapter" data-level="5.3" data-path="capítulo-5.html"><a href="capítulo-5.html#indice-alkire-y-foster-af---pobreza-multidimensional"><i class="fa fa-check"></i><b>5.3</b> Indice Alkire y Foster (AF) - Pobreza Multidimensional</a></li>
<li class="chapter" data-level="5.4" data-path="capítulo-5.html"><a href="capítulo-5.html#perfiles-de-pobreza"><i class="fa fa-check"></i><b>5.4</b> Perfiles de Pobreza</a></li>
<li class="chapter" data-level="5.5" data-path="capítulo-5.html"><a href="capítulo-5.html#perfiles-de-pobreza-condicionados"><i class="fa fa-check"></i><b>5.5</b> Perfiles de Pobreza Condicionados</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Apéndices del Libro Pobreza y Desigualdad en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="capítulo-4" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Capítulo 4</h1>
<div id="pobreza-monetaria" class="section level2 unlisted unnumbered">
<h2>Pobreza monetaria</h2>
<div id="escrito-por-cristian-bonavida-2" class="section level4 unnumbered">
<h4>Escrito por: Cristian Bonavida</h4>
</div>
<div id="last-update-2882021" class="section level4 unnumbered">
<h4>Last Update: 28/8/2021</h4>
<p>
 
</p>
<p><em>Códigos escritos en base a los apéndices del libro “Pobreza y Desigualdad en América Latina” de Gasparini, Cicowiez y Sosa Escudero. El objeto de este material es reproducir la rutina de códigos para STATA presentada en el libro al lenguaje R. Este material es solo de caracter complementario a las explicaciones y detalles conceptuales que se presentan en el libro de texto y los apéndices</em></p>
<p>
 
</p>
</div>
</div>
<div id="set-inicial-2" class="section level2 unnumbered">
<h2>Set Inicial</h2>
<p>Cargo las librerias, limpio environment, defino el path y atajo para función paste</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="capítulo-4.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb105-2"><a href="capítulo-4.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Data wrangling</span></span>
<span id="cb105-3"><a href="capítulo-4.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb105-4"><a href="capítulo-4.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb105-5"><a href="capítulo-4.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb105-6"><a href="capítulo-4.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb105-7"><a href="capítulo-4.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TAM)</span>
<span id="cb105-8"><a href="capítulo-4.html#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="capítulo-4.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())    <span class="co">#empiezo limpiando todo </span></span>
<span id="cb105-10"><a href="capítulo-4.html#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="capítulo-4.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;%+%&quot;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) <span class="fu">paste</span>(x,y,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)      <span class="co"># defino un shorcut parar concat de texto</span></span>
<span id="cb105-12"><a href="capítulo-4.html#cb105-12" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/HP/Desktop/CEDLAS - UNLP/Apendices en R/Material libro/encuestas-cedlas/Encuestas/&quot;</span>  <span class="co">#seteo directorio </span></span></code></pre></div>
<p>
 
</p>
</div>
<div id="indicador-fgt" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Indicador FGT</h2>
<p>###- (PÁG. 249-250)</p>
<p>En este apartado se presenta cómo calcular la familia de indicadores FGT. En primer lugar, se muestra cómo puede computarse el indicador FGT de manera relativamente sencilla. Luego, al igual que con el ratio de quintiles y el cálculo de quintiles, se introduce una función para el indicador FGT. Como ejemplo, computamos la pobreza de 2.5 dólares para Ecuador en 2006, utilizando microdatos que provienen de la Encuesta de Condiciones de Vida (ENCOVI).</p>
<p>Luego de cargar y limpiar las bases fijamos los valores de pobreza así como el parámetro <em>“alfa”</em> del indicador fgt de aversión a la desigualdad entre los pobres. Luego se computa, para cada individuo pobre, su brecha de pobreza elevada al valor de <em>“alfa”</em>, que se asigna a una nueva variable que llamamos <em>each</em>. La distinción entre individuo pobre y no pobre se operativiza en el comando <code>ifelse()</code>: en caso de cumplirse la condición de que el ingreso esté por debajo de la línea de pobreza, se computa la brecha, en caso de que sea falso se otorga un valor de cero. Por último se obtiene el valor de FGT como el promedio ponderado de la brecha en toda la muestra.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="capítulo-4.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cargo base y elimino observaciones incoherentes o con ingreso missing</span></span>
<span id="cb106-2"><a href="capítulo-4.html#cb106-2" aria-hidden="true" tabindex="-1"></a>ecu06 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Ecu/2006/bases/ecu06ecv_cedlas.dta&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="capítulo-4.html#cb106-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(cohh<span class="sc">==</span><span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(ipcf))     </span>
<span id="cb106-4"><a href="capítulo-4.html#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="capítulo-4.html#cb106-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> ecu06 </span>
<span id="cb106-6"><a href="capítulo-4.html#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="capítulo-4.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#linea de pobreza</span></span>
<span id="cb106-8"><a href="capítulo-4.html#cb106-8" aria-hidden="true" tabindex="-1"></a>lp<span class="ot">=</span><span class="fl">39.74</span></span>
<span id="cb106-9"><a href="capítulo-4.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co">#parametro alfa indicador fgt</span></span>
<span id="cb106-10"><a href="capítulo-4.html#cb106-10" aria-hidden="true" tabindex="-1"></a>alfa<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb106-11"><a href="capítulo-4.html#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="capítulo-4.html#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co">#computar fgt</span></span>
<span id="cb106-13"><a href="capítulo-4.html#cb106-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">each =</span> <span class="fu">ifelse</span>(ipcf<span class="sc">&lt;</span>lp, (<span class="dv">1</span> <span class="sc">-</span> ipcf<span class="sc">/</span>lp)<span class="sc">^</span>alfa, <span class="dv">0</span> ))   </span>
<span id="cb106-14"><a href="capítulo-4.html#cb106-14" aria-hidden="true" tabindex="-1"></a>fgt <span class="ot">=</span> <span class="fu">weighted.mean</span>(df<span class="sc">$</span>each, df<span class="sc">$</span>pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span>             </span>
<span id="cb106-15"><a href="capítulo-4.html#cb106-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-16"><a href="capítulo-4.html#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;fgt = &quot;</span> <span class="sc">%+%</span> <span class="fu">round</span>(fgt, <span class="at">d=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] &quot;fgt = 19.02&quot;</code></pre>
<p>Otra opción posible es computar los valores directamente como un vector, sin alojarlo como una nueva columna del data frame. Esta opción, desde el punto de vista del código, es más eficiente ya que se evita agregar una nueva columna que solo se emplea para el cálculo del indicador. El detalle a considerar es que para poder calcularlo como medida ponderada la cantidad de elementos del vector <em>“each”</em> debe ser exactamente igual la cantidad de observaciones de la columna <em>pondera</em> del dataframe.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="capítulo-4.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#alternativa</span></span>
<span id="cb108-2"><a href="capítulo-4.html#cb108-2" aria-hidden="true" tabindex="-1"></a>each <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>ipcf<span class="sc">&lt;</span>lp, (<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>ipcf<span class="sc">/</span>lp)<span class="sc">^</span>alfa, <span class="dv">0</span> )                </span>
<span id="cb108-3"><a href="capítulo-4.html#cb108-3" aria-hidden="true" tabindex="-1"></a>fgt <span class="ot">=</span> <span class="fu">weighted.mean</span>(each, df<span class="sc">$</span>pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span>   </span>
<span id="cb108-4"><a href="capítulo-4.html#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="capítulo-4.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;fgt = &quot;</span> <span class="sc">%+%</span> <span class="fu">round</span>(fgt, <span class="at">d=</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] &quot;fgt = 19.02&quot;</code></pre>
<p>
 
</p>
</div>
<div id="computar-fgt" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Computar FGT</h2>
<p>###- (pág 250-251)</p>
<p>Como ya vimos en el capítulo 3, las funciones nos permiten replicar un indicador o un cálculo en cualquier base, sobre cualquier variable, imponiendo una condición especifica o ponderando por algún factor de expansión. En este caso además agregamos como argumentos los parámetros asociados al FGT, <em>“alfa”</em>, para la aversión a la desigualdad, y <em>“zeta”</em> para la línea de pobreza. De esta forma podremos replicar y comparar rápidamente el índice para distintos valores que podemos pasarle a estos argumentos. La estructura de la función replica lo visto en las funciones del capítulo 3 hasta la línea 39 donde se computa el FGT con las mismas líneas que empleamos arriba. Adicionalmente se añade la opción de correr la función de forma silenciosa, sin imprimir el resultado.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb110-1"><a href="capítulo-4.html#cb110-1"></a>FGT <span class="ot">&lt;-</span> <span class="cf">function</span>(df, varname, <span class="at">var_pondera=</span><span class="cn">NULL</span>, <span class="at">condicion=</span><span class="cn">NULL</span>, alfa, zeta, <span class="at">quiet=</span><span class="cn">FALSE</span>) {</span>
<span id="cb110-2"><a href="capítulo-4.html#cb110-2"></a>  </span>
<span id="cb110-3"><a href="capítulo-4.html#cb110-3"></a>  aux <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df) </span>
<span id="cb110-4"><a href="capítulo-4.html#cb110-4"></a>  </span>
<span id="cb110-5"><a href="capítulo-4.html#cb110-5"></a>  varname_store <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(varname), aux) </span>
<span id="cb110-6"><a href="capítulo-4.html#cb110-6"></a>  aux <span class="ot">&lt;-</span> aux <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(varname_store)</span>
<span id="cb110-7"><a href="capítulo-4.html#cb110-7"></a>  </span>
<span id="cb110-8"><a href="capítulo-4.html#cb110-8"></a>  </span>
<span id="cb110-9"><a href="capítulo-4.html#cb110-9"></a>  <span class="co">#la condición es un argumento opcional</span></span>
<span id="cb110-10"><a href="capítulo-4.html#cb110-10"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">substitute</span>(condicion))) {</span>
<span id="cb110-11"><a href="capítulo-4.html#cb110-11"></a>      </span>
<span id="cb110-12"><a href="capítulo-4.html#cb110-12"></a>     <span class="cf">if</span>(<span class="fu">is</span>(<span class="fu">try</span>(<span class="fu">eval</span>(<span class="fu">substitute</span>(condicion)), <span class="at">silent =</span> <span class="cn">TRUE</span> ), <span class="st">&quot;try-error&quot;</span>))</span>
<span id="cb110-13"><a href="capítulo-4.html#cb110-13"></a>        </span>
<span id="cb110-14"><a href="capítulo-4.html#cb110-14"></a>        <span class="fu">stop</span>(<span class="st">&quot;ERROR: la condicion debe especificarse como character (entre comillas)&quot;</span>)</span>
<span id="cb110-15"><a href="capítulo-4.html#cb110-15"></a>      </span>
<span id="cb110-16"><a href="capítulo-4.html#cb110-16"></a>        aux <span class="ot">&lt;-</span> aux <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>condicion)))     </span>
<span id="cb110-17"><a href="capítulo-4.html#cb110-17"></a>                                                              </span>
<span id="cb110-18"><a href="capítulo-4.html#cb110-18"></a>   }</span>
<span id="cb110-19"><a href="capítulo-4.html#cb110-19"></a>    </span>
<span id="cb110-20"><a href="capítulo-4.html#cb110-20"></a>  </span>
<span id="cb110-21"><a href="capítulo-4.html#cb110-21"></a>  <span class="co">#set pondera igual a 1 si no está especificado</span></span>
<span id="cb110-22"><a href="capítulo-4.html#cb110-22"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">substitute</span>(var_pondera))) {                           </span>
<span id="cb110-23"><a href="capítulo-4.html#cb110-23"></a>    </span>
<span id="cb110-24"><a href="capítulo-4.html#cb110-24"></a>    var_pondera_store <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(aux)))</span>
<span id="cb110-25"><a href="capítulo-4.html#cb110-25"></a>    </span>
<span id="cb110-26"><a href="capítulo-4.html#cb110-26"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-27"><a href="capítulo-4.html#cb110-27"></a>    </span>
<span id="cb110-28"><a href="capítulo-4.html#cb110-28"></a>    var_pondera_store <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(var_pondera), aux)</span>
<span id="cb110-29"><a href="capítulo-4.html#cb110-29"></a>    </span>
<span id="cb110-30"><a href="capítulo-4.html#cb110-30"></a>  }</span>
<span id="cb110-31"><a href="capítulo-4.html#cb110-31"></a>  </span>
<span id="cb110-32"><a href="capítulo-4.html#cb110-32"></a>  </span>
<span id="cb110-33"><a href="capítulo-4.html#cb110-33"></a>  <span class="co">#Cómputo de brecha y valor del indicador</span></span>
<span id="cb110-34"><a href="capítulo-4.html#cb110-34"></a>  varname_store <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">substitute</span>(varname), aux)</span>
<span id="cb110-35"><a href="capítulo-4.html#cb110-35"></a>  aux <span class="ot">&lt;-</span> aux <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">each =</span> <span class="fu">ifelse</span>( varname_store <span class="sc">&lt;</span> zeta, </span>
<span id="cb110-36"><a href="capítulo-4.html#cb110-36"></a>                                     ( <span class="dv">1</span> <span class="sc">-</span> varname_store<span class="sc">/</span>zeta)<span class="sc">^</span>alfa, </span>
<span id="cb110-37"><a href="capítulo-4.html#cb110-37"></a>                                       <span class="dv">0</span> ))</span>
<span id="cb110-38"><a href="capítulo-4.html#cb110-38"></a>    </span>
<span id="cb110-39"><a href="capítulo-4.html#cb110-39"></a>  fgt <span class="ot">=</span> <span class="fu">weighted.mean</span>(aux<span class="sc">$</span>each, var_pondera_store, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb110-40"><a href="capítulo-4.html#cb110-40"></a>  fgt <span class="ot">=</span> <span class="fu">round</span>(fgt, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb110-41"><a href="capítulo-4.html#cb110-41"></a></span>
<span id="cb110-42"><a href="capítulo-4.html#cb110-42"></a>  <span class="co">#output</span></span>
<span id="cb110-43"><a href="capítulo-4.html#cb110-43"></a>  <span class="cf">if</span>(<span class="fu">substitute</span>(quiet)<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb110-44"><a href="capítulo-4.html#cb110-44"></a>    a<span class="ot">=</span>fgt</span>
<span id="cb110-45"><a href="capítulo-4.html#cb110-45"></a>    </span>
<span id="cb110-46"><a href="capítulo-4.html#cb110-46"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-47"><a href="capítulo-4.html#cb110-47"></a>    </span>
<span id="cb110-48"><a href="capítulo-4.html#cb110-48"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;FGT(alfa=&quot;</span>, alfa, <span class="st">&quot;,Z=&quot;</span>, zeta, <span class="st">&quot;) = &quot;</span>, fgt, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb110-49"><a href="capítulo-4.html#cb110-49"></a>    a<span class="ot">=</span>fgt</span>
<span id="cb110-50"><a href="capítulo-4.html#cb110-50"></a>    </span>
<span id="cb110-51"><a href="capítulo-4.html#cb110-51"></a>  }</span>
<span id="cb110-52"><a href="capítulo-4.html#cb110-52"></a>  </span>
<span id="cb110-53"><a href="capítulo-4.html#cb110-53"></a>}</span></code></pre></div>
<p>En las líneas siguientes se detallan algunos ejemplos de cómo replicar la función bajo distintas especificaciones.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="capítulo-4.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#No especifica condicion</span></span>
<span id="cb111-2"><a href="capítulo-4.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span><span class="fl">39.740</span>)</span></code></pre></div>
<pre><code>## [1] &quot;FGT(alfa=0,Z=39.74) = 19.02&quot;</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="capítulo-4.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Especifica condicion</span></span>
<span id="cb113-2"><a href="capítulo-4.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">condicion=</span><span class="st">&quot;urbano==1&quot;</span>, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span><span class="fl">39.740</span>)</span></code></pre></div>
<pre><code>## [1] &quot;FGT(alfa=0,Z=39.74) = 11.82&quot;</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="capítulo-4.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Especifica incorrectamente la condición</span></span>
<span id="cb115-2"><a href="capítulo-4.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">condicion=</span>urbano<span class="sc">==</span><span class="dv">1</span>, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span><span class="fl">39.740</span>)</span></code></pre></div>
<pre><code>## Error in FGT(df = df, varname = ipcf, var_pondera = pondera, condicion = urbano == : ERROR: la condicion debe especificarse como character (entre comillas)</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="capítulo-4.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Especifica opcion &quot;quiet&quot;</span></span>
<span id="cb117-2"><a href="capítulo-4.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span><span class="fl">39.740</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>
 
</p>
</div>
<div id="pobreza-relativa" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Pobreza relativa</h2>
<p>###- (pág. 251)</p>
<p>La estimación de la pobreza relativa implica, como primer paso, el cálculo de una línea de pobreza relativa. A modo de ejemplo, se computa una línea de pobreza igual al 50% del ingreso mediano de Ecuador. El comando <code>weightedMedian()</code> de la librería <code>matrixStats</code> arroja el valor de la mediana. Luego, el cálculo de la pobreza se realiza empleando la función FGT.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="capítulo-4.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linea de pobreza del 50% de la mediana del ingreso</span></span>
<span id="cb118-2"><a href="capítulo-4.html#cb118-2" aria-hidden="true" tabindex="-1"></a>lp <span class="ot">=</span> matrixStats<span class="sc">::</span><span class="fu">weightedMedian</span>(df<span class="sc">$</span>ipcf, df<span class="sc">$</span>pondera) <span class="sc">*</span> <span class="fl">0.50</span></span>
<span id="cb118-3"><a href="capítulo-4.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">condicion=</span><span class="st">&quot;urbano==1&quot;</span>, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp)</span></code></pre></div>
<pre><code>## [1] &quot;FGT(alfa=0,Z=47.484118603645) = 16.13&quot;</code></pre>
<p>
 
</p>
</div>
<div id="descompoisición-regional-de-la-pobreza" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Descompoisición regional de la pobreza</h2>
<p>###- (pág. 252-253)</p>
<p>El código a continuación realiza una descomposición por regiones de la tasa de incidencia de la pobreza (cuadro 4.7 del libro de texto). Para este caso utilizamos la Encuesta Nacional de Ingresos y Gastos de los Hogares de México para el año 2006 con la línea de pobreza de 2.5 dólares, equivalentes a 608.245 pesos mensuales.</p>
<p>Luego de cargar, limpiar e indicar la base de datos con la que se trabajará, se fija la línea de pobreza y se genera, a partir de la función de FGT, la tasa de incidencia para el total del país que se almacena en el objeto <em>“p0”</em>. En la línea siguiente, se toma una única observación de cada una de las 8 regiones diferentes de México y se las ordena en orden creciente para almacenarlas como un vector en el objeto <em>“list_rgn”</em>. Sobre este objeto haremos iterar un bucle, para que en cada vuelta los cálculos indicados se hagan para cada una de estas regiones.</p>
<p>La primer sentencia dentro de ese bucle, calcula la participación de la región sobre la población y en la siguiente línea se estima su indicador FGT para un valor de alfa=0 y con la línea de pobreza de 2.5 dólares (notar como se instrumenta la condición en la función). Por último la contribución se calcula como el producto entre la participación de cada región en la población total y el cociente entre la tasa de pobreza regional y la tasa de pobreza nacional. Se redondea y se indica que se imprima dicho valor.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="capítulo-4.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cargo y limpio base</span></span>
<span id="cb120-2"><a href="capítulo-4.html#cb120-2" aria-hidden="true" tabindex="-1"></a>mex06 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Mex/2006/bases/mex06_cedlas.dta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="capítulo-4.html#cb120-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(cohh<span class="sc">==</span><span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(ipcf))</span>
<span id="cb120-4"><a href="capítulo-4.html#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="capítulo-4.html#cb120-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mex06</span>
<span id="cb120-6"><a href="capítulo-4.html#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="capítulo-4.html#cb120-7" aria-hidden="true" tabindex="-1"></a>lp<span class="ot">=</span><span class="fl">608.245</span></span>
<span id="cb120-8"><a href="capítulo-4.html#cb120-8" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">=</span> <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb120-9"><a href="capítulo-4.html#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="capítulo-4.html#cb120-10" aria-hidden="true" tabindex="-1"></a>list_rgn <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">unique</span>(df<span class="sc">$</span>region))</span>
<span id="cb120-11"><a href="capítulo-4.html#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="capítulo-4.html#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="capítulo-4.html#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> list_rgn){</span>
<span id="cb120-14"><a href="capítulo-4.html#cb120-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-15"><a href="capítulo-4.html#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#participación region</span></span>
<span id="cb120-16"><a href="capítulo-4.html#cb120-16" aria-hidden="true" tabindex="-1"></a>  shr_rgn <span class="ot">=</span> <span class="fu">sum</span>(df<span class="sc">$</span>pondera[df<span class="sc">$</span>region<span class="sc">==</span>i]) <span class="sc">/</span> <span class="fu">sum</span>(df<span class="sc">$</span>pondera)</span>
<span id="cb120-17"><a href="capítulo-4.html#cb120-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fgt region</span></span>
<span id="cb120-18"><a href="capítulo-4.html#cb120-18" aria-hidden="true" tabindex="-1"></a>  p_r <span class="ot">&lt;-</span> <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">condicion=</span><span class="fu">paste</span>(<span class="st">&quot;region==&quot;</span>, i, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb120-19"><a href="capítulo-4.html#cb120-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-20"><a href="capítulo-4.html#cb120-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#contribución</span></span>
<span id="cb120-21"><a href="capítulo-4.html#cb120-21" aria-hidden="true" tabindex="-1"></a>  contribut <span class="ot">=</span> <span class="fu">round</span>( shr_rgn<span class="sc">*</span>(p_r<span class="sc">/</span>p0)<span class="sc">*</span><span class="dv">100</span> , <span class="at">digits =</span> <span class="dv">2</span> ) </span>
<span id="cb120-22"><a href="capítulo-4.html#cb120-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;contribución (%) region&quot;</span>, i, <span class="st">&quot;=&quot;</span>, contribut))</span>
<span id="cb120-23"><a href="capítulo-4.html#cb120-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-24"><a href="capítulo-4.html#cb120-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-25"><a href="capítulo-4.html#cb120-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;contribución (%) region 1 = 6.09&quot;
## [1] &quot;contribución (%) region 2 = 9.52&quot;
## [1] &quot;contribución (%) region 3 = 3.07&quot;
## [1] &quot;contribución (%) region 4 = 13.99&quot;
## [1] &quot;contribución (%) region 5 = 24.22&quot;
## [1] &quot;contribución (%) region 6 = 26.12&quot;
## [1] &quot;contribución (%) region 7 = 13.07&quot;
## [1] &quot;contribución (%) region 8 = 3.95&quot;</code></pre>
<p>
 
</p>
</div>
<div id="pobreza-según-consumo-e-ingreso" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Pobreza según consumo e ingreso</h2>
<p>###- (pág. 253-254)</p>
<p>El código que sigue puede utilizarse para replicar los resultados sobre pobreza por consumo e ingreso presentados en el cuadro 4.9 del texto para el caso de Nicaragua en 2005. Luego de fijar la tasa de pobreza relevante, el bucle hace que el objeto <em>”i”</em> tome valores desde 0.5 hasta 1.5 a intervalos de 0.1. Estos valores expanden la línea de pobreza que se utiliza para calcular el FGT sobre consumo (variable <em>cpcf</em>) e ingreso (variable <em>ipcf</em>)</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="capítulo-4.html#cb122-1" aria-hidden="true" tabindex="-1"></a>nic05 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Nic/2005/bases/nic05_cedlas.dta&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="capítulo-4.html#cb122-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(coh_oficial<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb122-3"><a href="capítulo-4.html#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="capítulo-4.html#cb122-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> nic05 </span>
<span id="cb122-5"><a href="capítulo-4.html#cb122-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-6"><a href="capítulo-4.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="co">#linea de pobreza oficial</span></span>
<span id="cb122-7"><a href="capítulo-4.html#cb122-7" aria-hidden="true" tabindex="-1"></a>lp0<span class="ot">=</span><span class="fl">576.5028</span></span>
<span id="cb122-8"><a href="capítulo-4.html#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="capítulo-4.html#cb122-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-10"><a href="capítulo-4.html#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>, <span class="at">by=</span><span class="fl">0.1</span>)) {</span>
<span id="cb122-11"><a href="capítulo-4.html#cb122-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-12"><a href="capítulo-4.html#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#linea de pobreza</span></span>
<span id="cb122-13"><a href="capítulo-4.html#cb122-13" aria-hidden="true" tabindex="-1"></a>  lp<span class="ot">=</span>lp0<span class="sc">*</span>i; lp<span class="ot">=</span><span class="fu">round</span>(lp, <span class="at">d=</span><span class="dv">2</span>)</span>
<span id="cb122-14"><a href="capítulo-4.html#cb122-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-15"><a href="capítulo-4.html#cb122-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#consumo</span></span>
<span id="cb122-16"><a href="capítulo-4.html#cb122-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot;*lp = &quot;</span>, lp, <span class="st">&quot;- Consumo&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb122-17"><a href="capítulo-4.html#cb122-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>cpcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp)</span>
<span id="cb122-18"><a href="capítulo-4.html#cb122-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-19"><a href="capítulo-4.html#cb122-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ingreso</span></span>
<span id="cb122-20"><a href="capítulo-4.html#cb122-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot;*lp = &quot;</span>, lp, <span class="st">&quot;- Ingreso&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb122-21"><a href="capítulo-4.html#cb122-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp)  </span>
<span id="cb122-22"><a href="capítulo-4.html#cb122-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-23"><a href="capítulo-4.html#cb122-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;0.5*lp = 288.25- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=288.25) = 12.21&quot;
## [1] &quot;0.5*lp = 288.25- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=288.25) = 16.59&quot;
## [1] &quot;0.6*lp = 345.9- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=345.9) = 19.03&quot;
## [1] &quot;0.6*lp = 345.9- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=345.9) = 22.91&quot;
## [1] &quot;0.7*lp = 403.55- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=403.55) = 26.23&quot;
## [1] &quot;0.7*lp = 403.55- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=403.55) = 28.51&quot;
## [1] &quot;0.8*lp = 461.2- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=461.2) = 33.63&quot;
## [1] &quot;0.8*lp = 461.2- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=461.2) = 33.77&quot;
## [1] &quot;0.9*lp = 518.85- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=518.85) = 40.06&quot;
## [1] &quot;0.9*lp = 518.85- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=518.85) = 38.76&quot;
## [1] &quot;1*lp = 576.5- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=576.5) = 46.02&quot;
## [1] &quot;1*lp = 576.5- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=576.5) = 43.62&quot;
## [1] &quot;1.1*lp = 634.15- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=634.15) = 52.18&quot;
## [1] &quot;1.1*lp = 634.15- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=634.15) = 47.75&quot;
## [1] &quot;1.2*lp = 691.8- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=691.8) = 56.67&quot;
## [1] &quot;1.2*lp = 691.8- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=691.8) = 51.33&quot;
## [1] &quot;1.3*lp = 749.45- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=749.45) = 60.71&quot;
## [1] &quot;1.3*lp = 749.45- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=749.45) = 54.91&quot;
## [1] &quot;1.4*lp = 807.1- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=807.1) = 64.76&quot;
## [1] &quot;1.4*lp = 807.1- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=807.1) = 58.29&quot;
## [1] &quot;1.5*lp = 864.75- Consumo&quot;
## [1] &quot;FGT(alfa=0,Z=864.75) = 68.21&quot;
## [1] &quot;1.5*lp = 864.75- Ingreso&quot;
## [1] &quot;FGT(alfa=0,Z=864.75) = 61.55&quot;</code></pre>
<p>En este caso el código imprime una larga lista de resultados en la consola. Con un cambio menor en el bucle, con las mismas sentencias, <em>podemos generar directamente la tabla a replicar y almacenarla como un dataframe que luego es exportable fácilmente a otros formatos para su presentación</em>. Para ello generamos inicialmente 3 vectores vacíos para cada una de las columnas que tendrá la tabla. Utilizamos un contador auxiliar que irá incrementándose de a uno en cada iteración del bucle, en las cuales iremos guardando los datos que antes se imprimían, ahora como elementos de estos objetos. Así, por ejemplo en la tercera iteración el cálculo de FGT se guardará como el tercer elemento del vector consumo y el vector ingreso. Al finalizar creamos un dataframe de 3 columnas a partir de estos 3 vectores, y por ultimo agregamos la cuarta columna calculando la diferencia.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="capítulo-4.html#cb124-1" aria-hidden="true" tabindex="-1"></a>consumo <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb124-2"><a href="capítulo-4.html#cb124-2" aria-hidden="true" tabindex="-1"></a>ingreso <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb124-3"><a href="capítulo-4.html#cb124-3" aria-hidden="true" tabindex="-1"></a>linea_pobreza <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb124-4"><a href="capítulo-4.html#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="capítulo-4.html#cb124-5" aria-hidden="true" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb124-6"><a href="capítulo-4.html#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="capítulo-4.html#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>, <span class="at">by=</span><span class="fl">0.1</span>)) {</span>
<span id="cb124-8"><a href="capítulo-4.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-9"><a href="capítulo-4.html#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#linea de pobreza</span></span>
<span id="cb124-10"><a href="capítulo-4.html#cb124-10" aria-hidden="true" tabindex="-1"></a>  lp<span class="ot">=</span>lp0<span class="sc">*</span>i; lp<span class="ot">=</span><span class="fu">round</span>(lp, <span class="at">d=</span><span class="dv">2</span>)</span>
<span id="cb124-11"><a href="capítulo-4.html#cb124-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-12"><a href="capítulo-4.html#cb124-12" aria-hidden="true" tabindex="-1"></a>  linea_pobreza[j] <span class="ot">&lt;-</span> <span class="fu">paste</span>(i, <span class="st">&quot;*lp&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb124-13"><a href="capítulo-4.html#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="capítulo-4.html#cb124-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#consumo</span></span>
<span id="cb124-15"><a href="capítulo-4.html#cb124-15" aria-hidden="true" tabindex="-1"></a>  consumo[j] <span class="ot">&lt;-</span> <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>cpcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-16"><a href="capítulo-4.html#cb124-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ingreso</span></span>
<span id="cb124-17"><a href="capítulo-4.html#cb124-17" aria-hidden="true" tabindex="-1"></a>  ingreso[j] <span class="ot">&lt;-</span> <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp, <span class="at">quiet =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb124-18"><a href="capítulo-4.html#cb124-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-19"><a href="capítulo-4.html#cb124-19" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">=</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb124-20"><a href="capítulo-4.html#cb124-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb124-21"><a href="capítulo-4.html#cb124-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-22"><a href="capítulo-4.html#cb124-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-23"><a href="capítulo-4.html#cb124-23" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(linea_pobreza, consumo, ingreso) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">diferencia =</span> ingreso <span class="sc">-</span> consumo)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["linea_pobreza"],"name":[1],"type":["chr"],"align":["left"]},{"label":["consumo"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ingreso"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["diferencia"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.5*lp","2":"12.21","3":"16.59","4":"4.38"},{"1":"0.6*lp","2":"19.03","3":"22.91","4":"3.88"},{"1":"0.7*lp","2":"26.23","3":"28.51","4":"2.28"},{"1":"0.8*lp","2":"33.63","3":"33.77","4":"0.14"},{"1":"0.9*lp","2":"40.06","3":"38.76","4":"-1.30"},{"1":"1*lp","2":"46.02","3":"43.62","4":"-2.40"},{"1":"1.1*lp","2":"52.18","3":"47.75","4":"-4.43"},{"1":"1.2*lp","2":"56.67","3":"51.33","4":"-5.34"},{"1":"1.3*lp","2":"60.71","3":"54.91","4":"-5.80"},{"1":"1.4*lp","2":"64.76","3":"58.29","4":"-6.47"},{"1":"1.5*lp","2":"68.21","3":"61.55","4":"-6.66"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>El código siguiente permite replicar la figura 4.13 del texto, que compara las funciones de distribución del ingreso y el consumo per cápita. Para ello se ordena de forma creciente por las variables de ingreso y luego de consumo, calculando en cada caso el share de población. El <em>“cutoff”</em> se utiliza para indicar qué porcentaje de las observaciones se mostrará en el gráfico.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="capítulo-4.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">##FUNCIÓN DE DISTRIBUCIÓN ACUMULADA</span></span>
<span id="cb125-2"><a href="capítulo-4.html#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="capítulo-4.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ordenar según ipcf y calcular shrpop</span></span>
<span id="cb125-4"><a href="capítulo-4.html#cb125-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ipcf) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">shrpop_i =</span> <span class="fu">cumsum</span>(pondera)<span class="sc">/</span><span class="fu">sum</span>(pondera))</span>
<span id="cb125-5"><a href="capítulo-4.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ordenar según cpcf y calcular shrpop</span></span>
<span id="cb125-6"><a href="capítulo-4.html#cb125-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(cpcf) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">shrpop_c =</span> <span class="fu">cumsum</span>(pondera)<span class="sc">/</span><span class="fu">sum</span>(pondera))</span>
<span id="cb125-7"><a href="capítulo-4.html#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="capítulo-4.html#cb125-8" aria-hidden="true" tabindex="-1"></a>cutoff<span class="ot">=</span><span class="fl">0.95</span></span>
<span id="cb125-9"><a href="capítulo-4.html#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="capítulo-4.html#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(shrpop_i <span class="sc">&lt;</span> cutoff), <span class="fu">aes</span>(<span class="at">x=</span>ipcf, <span class="at">y=</span>shrpop_i, <span class="at">linetype=</span><span class="st">&quot;Ingreso&quot;</span>))<span class="sc">+</span></span>
<span id="cb125-11"><a href="capítulo-4.html#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb125-12"><a href="capítulo-4.html#cb125-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#como la condición es sobre otra variable tengo que volver a indicar dataframe y aesthetic </span></span>
<span id="cb125-13"><a href="capítulo-4.html#cb125-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(shrpop_c <span class="sc">&lt;</span> cutoff), <span class="fu">aes</span>(<span class="at">x=</span>cpcf, <span class="at">y=</span>shrpop_c, <span class="at">linetype=</span><span class="st">&quot;Consumo&quot;</span>), <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb125-14"><a href="capítulo-4.html#cb125-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">&quot;Variable&quot;</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="at">Ingreso=</span><span class="st">&quot;solid&quot;</span>, <span class="at">Consumo=</span><span class="st">&quot;twodash&quot;</span>)) <span class="sc">+</span></span>
<span id="cb125-15"><a href="capítulo-4.html#cb125-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;proporción población&quot;</span>, <span class="at">x=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>
 
</p>
</div>
<div id="pobreza-por-edad" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Pobreza por edad</h2>
<p>###- (pág. 254-255)</p>
<p>El bloque de código siguiente muestra cómo puede graficarse la relación entre pobreza y edad (ver figura 4.15 del texto). Para ello luego de cargar, limpiar la base y definir la línea de pobreza, generamos dos objetos <em>“x”</em> e <em>“y”</em> vacíos donde se almacenará los valores del eje x y el eje y. Estos valores se generaran de forma iterativa mediante un bucle que incremente secuencialmente la edad en 5 años, comenzando en 0 y terminando en 80 años. En cada vuelta estaremos generando el indicador FGT condicionando a las observaciones que caigan dentro de distintos intervalos de edad. Esto equivale a dividir a la población en grupos de edad y para cada uno de ellos calcular el indicador. Al igual que en el código anterior, el contador nos permite almacenar los valores de edad y FGT como elementos de los vectores creados inicialmente.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="capítulo-4.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#indico con qué base de hogares voy a trabajar</span></span>
<span id="cb126-2"><a href="capítulo-4.html#cb126-2" aria-hidden="true" tabindex="-1"></a>mex06 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Mex/2006/bases/mex06_cedlas.dta&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="capítulo-4.html#cb126-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>(cohh<span class="sc">==</span><span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(ipcf))</span>
<span id="cb126-4"><a href="capítulo-4.html#cb126-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mex06 </span>
<span id="cb126-5"><a href="capítulo-4.html#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="capítulo-4.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co">#linea de pobreza oficial</span></span>
<span id="cb126-7"><a href="capítulo-4.html#cb126-7" aria-hidden="true" tabindex="-1"></a>lp0<span class="ot">=</span><span class="fl">608.245</span></span>
<span id="cb126-8"><a href="capítulo-4.html#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="capítulo-4.html#cb126-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb126-10"><a href="capítulo-4.html#cb126-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb126-11"><a href="capítulo-4.html#cb126-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-12"><a href="capítulo-4.html#cb126-12" aria-hidden="true" tabindex="-1"></a>j<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb126-13"><a href="capítulo-4.html#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="capítulo-4.html#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="at">by=</span><span class="dv">5</span>)) {</span>
<span id="cb126-15"><a href="capítulo-4.html#cb126-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-16"><a href="capítulo-4.html#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;rango = [&quot;</span>, i, <span class="st">&quot;,&quot;</span>, i<span class="sc">+</span><span class="dv">4</span>, <span class="st">&quot;]&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb126-17"><a href="capítulo-4.html#cb126-17" aria-hidden="true" tabindex="-1"></a>  fgt_edad <span class="ot">=</span> <span class="fu">FGT</span>(<span class="at">df=</span>df, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">condicion=</span><span class="fu">paste</span>(<span class="st">&quot;edad&gt;=&quot;</span>, i, <span class="st">&quot; &amp; edad&lt;=&quot;</span>, (i<span class="sc">+</span><span class="dv">4</span>), <span class="at">sep=</span><span class="st">&quot;&quot;</span>), </span>
<span id="cb126-18"><a href="capítulo-4.html#cb126-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-19"><a href="capítulo-4.html#cb126-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-20"><a href="capítulo-4.html#cb126-20" aria-hidden="true" tabindex="-1"></a>  x[j]<span class="ot">=</span>i</span>
<span id="cb126-21"><a href="capítulo-4.html#cb126-21" aria-hidden="true" tabindex="-1"></a>  y[j]<span class="ot">=</span>fgt_edad</span>
<span id="cb126-22"><a href="capítulo-4.html#cb126-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-23"><a href="capítulo-4.html#cb126-23" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">=</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb126-24"><a href="capítulo-4.html#cb126-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-25"><a href="capítulo-4.html#cb126-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;rango = [0,4]&quot;
## [1] &quot;rango = [5,9]&quot;
## [1] &quot;rango = [10,14]&quot;
## [1] &quot;rango = [15,19]&quot;
## [1] &quot;rango = [20,24]&quot;
## [1] &quot;rango = [25,29]&quot;
## [1] &quot;rango = [30,34]&quot;
## [1] &quot;rango = [35,39]&quot;
## [1] &quot;rango = [40,44]&quot;
## [1] &quot;rango = [45,49]&quot;
## [1] &quot;rango = [50,54]&quot;
## [1] &quot;rango = [55,59]&quot;
## [1] &quot;rango = [60,64]&quot;
## [1] &quot;rango = [65,69]&quot;
## [1] &quot;rango = [70,74]&quot;
## [1] &quot;rango = [75,79]&quot;
## [1] &quot;rango = [80,84]&quot;</code></pre>
<p>Las líneas finales grafican los resultados, superponiendo a las estimaciones de pobreza una línea de regresión polinomial de orden dos.
.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="capítulo-4.html#cb128-1" aria-hidden="true" tabindex="-1"></a>xst<span class="ot">=</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb128-2"><a href="capítulo-4.html#cb128-2" aria-hidden="true" tabindex="-1"></a>aux <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y, xst)</span>
<span id="cb128-3"><a href="capítulo-4.html#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="capítulo-4.html#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aux, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb128-5"><a href="capítulo-4.html#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb128-6"><a href="capítulo-4.html#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) , <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>
 
</p>
</div>
<div id="significatividad-estadistica" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Significatividad estadistica</h2>
<p>###- (pág. 255-256)</p>
<p>En esta última sección recreamos la técnica del <em>boostrap</em> o reseampleo para obtener errores estándares e intervalos de confianza para las estimaciones del FGT. La versión más simple del bootstrap requiere (i) tomar una muestra de tamaño N (el tamaño muestral) de la muestra original con reemplazo, (ii) computar el índice de pobreza deseado y (iii) repetir el procedimiento B veces, con B grande. Esto es lo que haremos mediante un bucle, fijaremos una cantidad de repeticiones, en las que en cada una estaremos tomando un resampleo de la muestra original de igual tamaño. De esta forma la muestra irá cambiando en su composición aleatoriamente y por tanto permitirá generar distintos valores del FGT en cada iteración, a partir de una misma base. El comando en R <code>sample_n()</code> realiza esta tarea de resampleo, seteando el dataframe, el tamaño de la nueva muestra y la opción con reposición. La expresión <code>nrow(df)</code> indica que la nueva muestra tendrá el mismo tamaño que la base original. Cada valor del indicador se almacena en el objeto <em>“store”</em>, sobre el que posteriormente se calcula el desvío, la media y el tamaño. Estos son inputs necesarios para la fórmula que estima los intervalos de confianza de nuestras estimaciones. En este caso estimamos un intervalo de confianza del 95%.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="capítulo-4.html#cb129-1" aria-hidden="true" tabindex="-1"></a>per06 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Per/2006/bases/per06_cedlas.dta&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="capítulo-4.html#cb129-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(cohh<span class="sc">==</span><span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(ipcf))</span>
<span id="cb129-3"><a href="capítulo-4.html#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="capítulo-4.html#cb129-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> per06</span>
<span id="cb129-5"><a href="capítulo-4.html#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="capítulo-4.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co">#genero un resampleo del data frame en cada iteración y para ese data frame obtengo el fgt</span></span>
<span id="cb129-7"><a href="capítulo-4.html#cb129-7" aria-hidden="true" tabindex="-1"></a>store <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb129-8"><a href="capítulo-4.html#cb129-8" aria-hidden="true" tabindex="-1"></a>rep<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb129-9"><a href="capítulo-4.html#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="capítulo-4.html#cb129-10" aria-hidden="true" tabindex="-1"></a>lp <span class="ot">=</span> <span class="fl">128.136</span></span>
<span id="cb129-11"><a href="capítulo-4.html#cb129-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-12"><a href="capítulo-4.html#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb129-13"><a href="capítulo-4.html#cb129-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-14"><a href="capítulo-4.html#cb129-14" aria-hidden="true" tabindex="-1"></a>   df_sample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(df, <span class="at">size=</span><span class="fu">nrow</span>(df), <span class="at">replace=</span>T)</span>
<span id="cb129-15"><a href="capítulo-4.html#cb129-15" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-16"><a href="capítulo-4.html#cb129-16" aria-hidden="true" tabindex="-1"></a>   fgt <span class="ot">=</span> <span class="fu">FGT</span>(<span class="at">df=</span>df_sample, <span class="at">varname=</span>ipcf, <span class="at">var_pondera=</span>pondera, <span class="at">alfa=</span><span class="dv">0</span>, <span class="at">zeta=</span>lp, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-17"><a href="capítulo-4.html#cb129-17" aria-hidden="true" tabindex="-1"></a>   store[i] <span class="ot">=</span> fgt</span>
<span id="cb129-18"><a href="capítulo-4.html#cb129-18" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-19"><a href="capítulo-4.html#cb129-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="capítulo-4.html#cb130-1" aria-hidden="true" tabindex="-1"></a>store</span></code></pre></div>
<pre><code>##  [1] 25.30 25.08 25.40 24.95 25.30 25.08 25.15 25.44 24.89 24.99 25.32 25.30
## [13] 25.15 25.23 25.05 25.08 25.01 25.23 25.22 25.22 25.11 25.30 25.51 25.20
## [25] 25.24 25.11 25.02 25.44 25.28 25.26 25.26 24.90 25.26 25.11 25.34 25.19
## [37] 25.20 25.12 25.43 24.90 25.22 25.45 25.12 25.31 25.09 25.43 25.33 25.16
## [49] 25.16 25.11</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="capítulo-4.html#cb132-1" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">=</span><span class="fu">sd</span>(store)</span>
<span id="cb132-2"><a href="capítulo-4.html#cb132-2" aria-hidden="true" tabindex="-1"></a>mean<span class="ot">=</span><span class="fu">mean</span>(store)</span>
<span id="cb132-3"><a href="capítulo-4.html#cb132-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(store)</span>
<span id="cb132-4"><a href="capítulo-4.html#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="capítulo-4.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co">#con intervalo de confianza del 95%</span></span>
<span id="cb132-6"><a href="capítulo-4.html#cb132-6" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb132-7"><a href="capítulo-4.html#cb132-7" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> mean <span class="sc">-</span> error; left</span></code></pre></div>
<pre><code>## [1] 25.1559</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="capítulo-4.html#cb134-1" aria-hidden="true" tabindex="-1"></a>right <span class="ot">&lt;-</span> mean <span class="sc">+</span> error; right</span></code></pre></div>
<pre><code>## [1] 25.2421</code></pre>
<p>A modo de extensión es fácil escribir una función que, tomando los resultados alojados en un vector y el intervalo de confianza deseado, nos devuelve directamente el cálculo del intervalo.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="capítulo-4.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#también es posible hacer un función para calcular los intervalos de confianza</span></span>
<span id="cb136-2"><a href="capítulo-4.html#cb136-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="cf">function</span>(vector, intervalo){</span>
<span id="cb136-3"><a href="capítulo-4.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-4"><a href="capítulo-4.html#cb136-4" aria-hidden="true" tabindex="-1"></a>  sd<span class="ot">=</span><span class="fu">sd</span>(vector)</span>
<span id="cb136-5"><a href="capítulo-4.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  mean<span class="ot">=</span><span class="fu">mean</span>(vector)</span>
<span id="cb136-6"><a href="capítulo-4.html#cb136-6" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span> <span class="fu">length</span>(vector)</span>
<span id="cb136-7"><a href="capítulo-4.html#cb136-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-8"><a href="capítulo-4.html#cb136-8" aria-hidden="true" tabindex="-1"></a>  error <span class="ot">&lt;-</span> <span class="fu">qt</span>((intervalo<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>n<span class="dv">-1</span>) <span class="sc">*</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb136-9"><a href="capítulo-4.html#cb136-9" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> mean <span class="sc">-</span> error, <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> mean <span class="sc">+</span> error)</span>
<span id="cb136-10"><a href="capítulo-4.html#cb136-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb136-11"><a href="capítulo-4.html#cb136-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="capítulo-4.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci</span>(store, <span class="fl">0.90</span>)</span></code></pre></div>
<pre><code>##    lower    upper 
## 25.16304 25.23496</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="capítulo-4.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci</span>(store, <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   lower   upper 
## 25.1559 25.2421</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="capítulo-4.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci</span>(store, <span class="fl">0.99</span>)</span></code></pre></div>
<pre><code>##    lower    upper 
## 25.14153 25.25647</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="capítulo-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="capítulo-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Cap4_html.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
