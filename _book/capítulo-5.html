<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Capítulo 5 | Apéndices del Libro Pobreza y Desigualdad en R</title>
  <meta name="description" content="Nos propusimos trasncribir al lenguaje R y Python los apéndices del libro Pobreza y Desigualdad en América Latina de Gasparini, Cicowiez y Sosa Escudero que originalmente fueron escritos para Stata." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Capítulo 5 | Apéndices del Libro Pobreza y Desigualdad en R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/portada_libro_cover.png" />
  <meta property="og:description" content="Nos propusimos trasncribir al lenguaje R y Python los apéndices del libro Pobreza y Desigualdad en América Latina de Gasparini, Cicowiez y Sosa Escudero que originalmente fueron escritos para Stata." />
  <meta name="github-repo" content="crisbonavida/Pobreza_Desigualdad_codes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Capítulo 5 | Apéndices del Libro Pobreza y Desigualdad en R" />
  
  <meta name="twitter:description" content="Nos propusimos trasncribir al lenguaje R y Python los apéndices del libro Pobreza y Desigualdad en América Latina de Gasparini, Cicowiez y Sosa Escudero que originalmente fueron escritos para Stata." />
  <meta name="twitter:image" content="/portada_libro_cover.png" />



<meta name="date" content="2022-02-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="capítulo-4.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Una herramienta práctica para trabajar con datos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bienvenidos</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-este-proyecto"><i class="fa fa-check"></i>Sobre este Proyecto:</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#el-libro"><i class="fa fa-check"></i>El Libro</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="capítulo-2.html"><a href="capítulo-2.html"><i class="fa fa-check"></i><b>2</b> Capítulo 2</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-2.html"><a href="capítulo-2.html#set-inicial"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="2.1" data-path="capítulo-2.html"><a href="capítulo-2.html#introducción-ejemplo-brasil"><i class="fa fa-check"></i><b>2.1</b> Introducción: ejemplo Brasil</a></li>
<li class="chapter" data-level="2.2" data-path="capítulo-2.html"><a href="capítulo-2.html#histogramas"><i class="fa fa-check"></i><b>2.2</b> Histogramas</a></li>
<li class="chapter" data-level="2.3" data-path="capítulo-2.html"><a href="capítulo-2.html#función-de-distribución"><i class="fa fa-check"></i><b>2.3</b> Función de distribución</a></li>
<li class="chapter" data-level="2.4" data-path="capítulo-2.html"><a href="capítulo-2.html#pareto"><i class="fa fa-check"></i><b>2.4</b> Pareto</a></li>
<li class="chapter" data-level="2.5" data-path="capítulo-2.html"><a href="capítulo-2.html#box-plot"><i class="fa fa-check"></i><b>2.5</b> Box-plot</a></li>
<li class="chapter" data-level="2.6" data-path="capítulo-2.html"><a href="capítulo-2.html#curva-de-lorenz"><i class="fa fa-check"></i><b>2.6</b> Curva de Lorenz</a></li>
<li class="chapter" data-level="2.7" data-path="capítulo-2.html"><a href="capítulo-2.html#curva-generalizada-de-lorenz"><i class="fa fa-check"></i><b>2.7</b> Curva Generalizada de Lorenz</a></li>
<li class="chapter" data-level="2.8" data-path="capítulo-2.html"><a href="capítulo-2.html#curva-de-incidencia"><i class="fa fa-check"></i><b>2.8</b> Curva de Incidencia</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="capítulo-3.html"><a href="capítulo-3.html"><i class="fa fa-check"></i><b>3</b> Capítulo 3</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-3.html"><a href="capítulo-3.html#set-inicial-1"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="3.1" data-path="capítulo-3.html"><a href="capítulo-3.html#cociente-de-cuantiles"><i class="fa fa-check"></i><b>3.1</b> Cociente de cuantiles</a></li>
<li class="chapter" data-level="3.2" data-path="capítulo-3.html"><a href="capítulo-3.html#replicar-programa-ratq51"><i class="fa fa-check"></i><b>3.2</b> Replicar programa ratq51</a></li>
<li class="chapter" data-level="3.3" data-path="capítulo-3.html"><a href="capítulo-3.html#replicar-programa-gcuan"><i class="fa fa-check"></i><b>3.3</b> Replicar programa gcuan</a></li>
<li class="chapter" data-level="3.4" data-path="capítulo-3.html"><a href="capítulo-3.html#tamaño-de-los-hogares"><i class="fa fa-check"></i><b>3.4</b> Tamaño de los hogares</a></li>
<li class="chapter" data-level="3.5" data-path="capítulo-3.html"><a href="capítulo-3.html#la-distribución-intrahogar"><i class="fa fa-check"></i><b>3.5</b> La distribución intrahogar</a></li>
<li class="chapter" data-level="3.6" data-path="capítulo-3.html"><a href="capítulo-3.html#empleo-de-ponderadores"><i class="fa fa-check"></i><b>3.6</b> Empleo de ponderadores</a></li>
<li class="chapter" data-level="3.7" data-path="capítulo-3.html"><a href="capítulo-3.html#diseño-muestral"><i class="fa fa-check"></i><b>3.7</b> Diseño muestraL</a></li>
<li class="chapter" data-level="3.8" data-path="capítulo-3.html"><a href="capítulo-3.html#fuentes-de-ingreso"><i class="fa fa-check"></i><b>3.8</b> Fuentes de ingreso</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="capítulo-4.html"><a href="capítulo-4.html"><i class="fa fa-check"></i><b>4</b> Capítulo 4</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-4.html"><a href="capítulo-4.html#set-inicial-2"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="4.1" data-path="capítulo-4.html"><a href="capítulo-4.html#indicador-fgt"><i class="fa fa-check"></i><b>4.1</b> Indicador FGT</a></li>
<li class="chapter" data-level="4.2" data-path="capítulo-4.html"><a href="capítulo-4.html#computar-fgt"><i class="fa fa-check"></i><b>4.2</b> Computar FGT</a></li>
<li class="chapter" data-level="4.3" data-path="capítulo-4.html"><a href="capítulo-4.html#pobreza-relativa"><i class="fa fa-check"></i><b>4.3</b> Pobreza relativa</a></li>
<li class="chapter" data-level="4.4" data-path="capítulo-4.html"><a href="capítulo-4.html#descompoisición-regional-de-la-pobreza"><i class="fa fa-check"></i><b>4.4</b> Descompoisición regional de la pobreza</a></li>
<li class="chapter" data-level="4.5" data-path="capítulo-4.html"><a href="capítulo-4.html#pobreza-según-consumo-e-ingreso"><i class="fa fa-check"></i><b>4.5</b> Pobreza según consumo e ingreso</a></li>
<li class="chapter" data-level="4.6" data-path="capítulo-4.html"><a href="capítulo-4.html#pobreza-por-edad"><i class="fa fa-check"></i><b>4.6</b> Pobreza por edad</a></li>
<li class="chapter" data-level="4.7" data-path="capítulo-4.html"><a href="capítulo-4.html#significatividad-estadistica"><i class="fa fa-check"></i><b>4.7</b> Significatividad estadistica</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="capítulo-5.html"><a href="capítulo-5.html"><i class="fa fa-check"></i><b>5</b> Capítulo 5</a>
<ul>
<li class="chapter" data-level="" data-path="capítulo-5.html"><a href="capítulo-5.html#set-inicial-3"><i class="fa fa-check"></i>Set Inicial</a></li>
<li class="chapter" data-level="5.1" data-path="capítulo-5.html"><a href="capítulo-5.html#pobreza-multidimensional"><i class="fa fa-check"></i><b>5.1</b> Pobreza Multidimensional</a></li>
<li class="chapter" data-level="5.2" data-path="capítulo-5.html"><a href="capítulo-5.html#indice-bourguignon-y-chakravarty-bc---pobreza-multidimensional"><i class="fa fa-check"></i><b>5.2</b> Indice Bourguignon y Chakravarty (BC) - Pobreza Multidimensional</a></li>
<li class="chapter" data-level="5.3" data-path="capítulo-5.html"><a href="capítulo-5.html#indice-alkire-y-foster-af---pobreza-multidimensional"><i class="fa fa-check"></i><b>5.3</b> Indice Alkire y Foster (AF) - Pobreza Multidimensional</a></li>
<li class="chapter" data-level="5.4" data-path="capítulo-5.html"><a href="capítulo-5.html#perfiles-de-pobreza"><i class="fa fa-check"></i><b>5.4</b> Perfiles de Pobreza</a></li>
<li class="chapter" data-level="5.5" data-path="capítulo-5.html"><a href="capítulo-5.html#perfiles-de-pobreza-condicionados"><i class="fa fa-check"></i><b>5.5</b> Perfiles de Pobreza Condicionados</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Apéndices del Libro Pobreza y Desigualdad en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="capítulo-5" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Capítulo 5</h1>
<div id="apéndices-del-libro-pobreza-y-desigualdad-en-r-3" class="section level2 unlisted unnumbered">
<h2>Apéndices del Libro Pobreza y Desigualdad en R</h2>
<div id="escrito-por-cristian-bonavida-3" class="section level4 unnumbered">
<h4>Escrito por: Cristian Bonavida</h4>
</div>
<div id="last-update-0272021-2" class="section level4 unnumbered">
<h4>Last Update: 02/7/2021</h4>
<p>
 
</p>
<p><em>Códigos escritos en base a los apéndices del libro “Pobreza y Desigualdad en América Latina” de Gasparini, Cicowiez y Sosa Escudero. El objeto de este material es reproducir la rutina de códigos para STATA presentada en el libro al lenguaje R. Este material es solo de caracter complementario a las explicaciones y detalles conceptuales que se presentan en el libro de texto y los apéndices</em></p>
<p>
 
</p>
</div>
</div>
<div id="set-inicial-3" class="section level2 unnumbered">
<h2>Set Inicial</h2>
<p>Cargo las librerias, limpio enviroment, defino el path y atajo para funcion paste</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="capítulo-5.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb140-2"><a href="capítulo-5.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Data wrangling</span></span>
<span id="cb140-3"><a href="capítulo-5.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb140-4"><a href="capítulo-5.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb140-5"><a href="capítulo-5.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb140-6"><a href="capítulo-5.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb140-7"><a href="capítulo-5.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TAM)</span>
<span id="cb140-8"><a href="capítulo-5.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb140-9"><a href="capítulo-5.html#cb140-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-10"><a href="capítulo-5.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())    <span class="co">#empiezo limpiando todo </span></span>
<span id="cb140-11"><a href="capítulo-5.html#cb140-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-12"><a href="capítulo-5.html#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;%+%&quot;</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) <span class="fu">paste</span>(x,y,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)      <span class="co"># defino un shorcut parar concat de texto</span></span>
<span id="cb140-13"><a href="capítulo-5.html#cb140-13" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/HP/Desktop/CEDLAS - UNLP/Apendices en R/Material libro/encuestas-cedlas/Encuestas/&quot;</span>  <span class="co">#seteo directorio </span></span></code></pre></div>
<p>
 
</p>
</div>
<div id="pobreza-multidimensional" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Pobreza Multidimensional</h2>
<p>###- (pág. 334-335)</p>
<p>En este primer apartado se muestra cómo puede replicarse el cuadro 5.1 del libro, sobre tasas de pobreza multidimensional en Nicaragua, Perú y Uruguay. Comenzamos cargando y defiendo la base a utilizar</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="capítulo-5.html#cb141-1" aria-hidden="true" tabindex="-1"></a>nic05 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Nic/2005/bases/nic05_cedlas.dta&quot;</span>)      </span>
<span id="cb141-2"><a href="capítulo-5.html#cb141-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> nic05</span></code></pre></div>
<p>Nos asegurarnos de convertir los missings que puede contener la variable pondera a 0. De esta manera al calcular estimadores ponderados los valores para estas observaciones no tienen ningun peso y evitamos que los missings afecten el nuestros cálculos.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="capítulo-5.html#cb142-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>pondera <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(df<span class="sc">$</span>pondera), <span class="dv">0</span>, df<span class="sc">$</span>pondera)</span></code></pre></div>
<p>El bloque de código siguiente asigna a todos los miembros del hogar las variables que solo están definidas para el jefe de hogar. Como se trata de variables relacionadas con las características de la vivienda, típicamente se encuentran
en las bases de datos de hogares y no de personas.</p>
<p>En STATA la solución se propone con un bucle. En este caso aplicamos la misma lógica pero nos valemos de la función <code>across</code> que nos permite realizar un mismo cálculo para un conjunto de columnas especificadas. Previamente debemos ordenar y agrupar las observaciones por id.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="capítulo-5.html#cb143-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(id) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="capítulo-5.html#cb143-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb143-3"><a href="capítulo-5.html#cb143-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">across</span>(</span>
<span id="cb143-4"><a href="capítulo-5.html#cb143-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.cols  =</span> <span class="fu">c</span>(habita, matpreca, agua, banio), <span class="co">#sobre qué columnas aplicar operación</span></span>
<span id="cb143-5"><a href="capítulo-5.html#cb143-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.fns   =</span> mean,   <span class="co">#que operación/función queremos realizar</span></span>
<span id="cb143-6"><a href="capítulo-5.html#cb143-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">na.rm =</span> <span class="cn">TRUE</span>,                                 </span>
<span id="cb143-7"><a href="capítulo-5.html#cb143-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.names =</span> <span class="st">&quot;{col}&quot;</span> <span class="co">#como deben llamarse las nuevas variables</span></span>
<span id="cb143-8"><a href="capítulo-5.html#cb143-8" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb143-9"><a href="capítulo-5.html#cb143-9" aria-hidden="true" tabindex="-1"></a>                  )</span></code></pre></div>
<p>La expresión <code>names = "{col}"</code> indica que el nombre de las nuevas columnas sea el nombre de las variables orginales, por lo que las estamos sobreescribiendo.</p>
<p>En las siguiente bloque de código calculamos los indicadores de pobreza para cada una de las dimensiones relevantes, creando un nueva variable en el data frame para cada caso. Empleamos el comando <code>ifelse</code> cuando el cálculo es directo y <code>mutate</code> cuando se requiere de una variable auxiliar previa.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="capítulo-5.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) ipcf &lt; 2.5 USD</span></span>
<span id="cb144-2"><a href="capítulo-5.html#cb144-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>indic1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>ipcf <span class="sc">&lt;</span> <span class="fl">564.12</span>, <span class="dv">1</span> ,<span class="dv">0</span>)</span>
<span id="cb144-3"><a href="capítulo-5.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="capítulo-5.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) mas de 3 miembros por cuarto</span></span>
<span id="cb144-5"><a href="capítulo-5.html#cb144-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb144-6"><a href="capítulo-5.html#cb144-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">rat_miembros_cuartos =</span> miembros<span class="sc">/</span>habita,</span>
<span id="cb144-7"><a href="capítulo-5.html#cb144-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">aux =</span> <span class="fu">case_when</span>(</span>
<span id="cb144-8"><a href="capítulo-5.html#cb144-8" aria-hidden="true" tabindex="-1"></a>                    (rat_miembros_cuartos<span class="sc">&gt;</span><span class="dv">3</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rat_miembros_cuartos)) <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb144-9"><a href="capítulo-5.html#cb144-9" aria-hidden="true" tabindex="-1"></a>                    (rat_miembros_cuartos<span class="sc">&lt;=</span><span class="dv">3</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rat_miembros_cuartos)) <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb144-10"><a href="capítulo-5.html#cb144-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">indic2=</span><span class="fu">max</span>(aux)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>aux)</span>
<span id="cb144-11"><a href="capítulo-5.html#cb144-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-12"><a href="capítulo-5.html#cb144-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) vivienda construida con material precario</span></span>
<span id="cb144-13"><a href="capítulo-5.html#cb144-13" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>indic3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>matpreca<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span> ,<span class="dv">0</span>)</span>
<span id="cb144-14"><a href="capítulo-5.html#cb144-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-15"><a href="capítulo-5.html#cb144-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) vivienda sin acceso a agua potable</span></span>
<span id="cb144-16"><a href="capítulo-5.html#cb144-16" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>indic4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>agua<span class="sc">==</span><span class="dv">0</span>, <span class="dv">1</span> ,<span class="dv">0</span>)</span>
<span id="cb144-17"><a href="capítulo-5.html#cb144-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-18"><a href="capítulo-5.html#cb144-18" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) vivienda sin acceso a baño sanitario </span></span>
<span id="cb144-19"><a href="capítulo-5.html#cb144-19" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>indic5 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>banio<span class="sc">==</span><span class="dv">0</span>, <span class="dv">1</span> ,<span class="dv">0</span>)</span>
<span id="cb144-20"><a href="capítulo-5.html#cb144-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-21"><a href="capítulo-5.html#cb144-21" aria-hidden="true" tabindex="-1"></a><span class="co"># (6) educación promedio menor a 7 años solo para el jefe y conyuge</span></span>
<span id="cb144-22"><a href="capítulo-5.html#cb144-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">aedu_avg =</span> <span class="fu">ifelse</span>(jefe<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> conyuge<span class="sc">==</span><span class="dv">1</span>, <span class="fu">mean</span>(aedu, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="cn">NA</span>),</span>
<span id="cb144-23"><a href="capítulo-5.html#cb144-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">aux =</span> <span class="fu">ifelse</span>(aedu_avg<span class="sc">&lt;</span><span class="dv">7</span> <span class="sc">&amp;</span> jefe<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span> ,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb144-24"><a href="capítulo-5.html#cb144-24" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">indic6 =</span> <span class="fu">max</span>(aux))  <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>aux)</span></code></pre></div>
<p>Seguidamente obtenemos el porcentaje de personas con privaciones para cada indicador, utilizando la media ponderada.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="capítulo-5.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(df<span class="sc">$</span>indic1, df<span class="sc">$</span>pondera, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 42.66527</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="capítulo-5.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(df<span class="sc">$</span>indic2, df<span class="sc">$</span>pondera, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 35.15812</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="capítulo-5.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(df<span class="sc">$</span>indic3, df<span class="sc">$</span>pondera, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 14.43805</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="capítulo-5.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(df<span class="sc">$</span>indic4, df<span class="sc">$</span>pondera, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 37.31393</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="capítulo-5.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(df<span class="sc">$</span>indic5, df<span class="sc">$</span>pondera, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 73.09805</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="capítulo-5.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(df<span class="sc">$</span>indic6, df<span class="sc">$</span>pondera, <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 73.3585</code></pre>
<p>La variable “npriv” contiene el número de privaciones de cada individuo. Para crearla utilizamos una operación a nivel de fila con el comando <code>rowSums</code> que, combinado con <code>across</code>, nos permite sumar todas las columnas especificadas. En este caso especificamos todas las columnas que comienzan con el patron “indic.” Notese que a diferencia del uso anterior aqui no se realiza una misma operación repetida para cada columna sino que se especifican las columnas que se incluyen como argumento de la operación suma.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="capítulo-5.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#contar condiciones:por fila sumo todas las columnas que comienzan con indic</span></span>
<span id="cb157-2"><a href="capítulo-5.html#cb157-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">npriv =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;indic&quot;</span>)))) </span></code></pre></div>
<p>Una forma alternativa más intuitiva sería especificar manualmente las columnas a sumar, pero se vuelve poco efeciente en el caso de que estas sean numerosas, por lo que la posibilidad de identificar columnas por patrones se vuelve particularmente atractiva.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="capítulo-5.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#manera alternativa</span></span>
<span id="cb158-2"><a href="capítulo-5.html#cb158-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>npriv <span class="ot">=</span> df<span class="sc">$</span>indic1 <span class="sc">+</span> df<span class="sc">$</span>indic2 <span class="sc">+</span> df<span class="sc">$</span>indic3 <span class="sc">+</span> df<span class="sc">$</span>indic4 <span class="sc">+</span> df<span class="sc">$</span>indic5 <span class="sc">+</span> df<span class="sc">$</span>indic6   </span></code></pre></div>
<p>A partir de la variable “npriv” se generan las variables “pobre1” a “pobre6” que valen 1 de acuerdo con la cantidad de privaciones que sufre cada individuo. Por ejemplo, la variable “pobre4” vale 1 para los individuos que tienen 4 o más privaciones, y 0 en caso contrario.</p>
<p>En cada iteración se concatena el prefijo <em>pobre</em> con el contador <code>i</code>, dandole nombre a cada nueva columna del data frame. Luego se calcula el porcentaje como la media ponderada de esta columna, se redondea e imprime el resultado.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="capítulo-5.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#condición de pobreza segun cantidad de privaciones</span></span>
<span id="cb159-2"><a href="capítulo-5.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb159-3"><a href="capítulo-5.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-4"><a href="capítulo-5.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  df[<span class="fu">paste</span>(<span class="st">&quot;pobre&quot;</span>,i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>npriv<span class="sc">&gt;=</span>i, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb159-5"><a href="capítulo-5.html#cb159-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-6"><a href="capítulo-5.html#cb159-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">weighted.mean</span>(df[<span class="fu">paste</span>(<span class="st">&quot;pobre&quot;</span>,i,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)], df[<span class="st">&quot;pondera&quot;</span>], <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb159-7"><a href="capítulo-5.html#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot; privaciones = &quot;</span>, <span class="fu">round</span>(p, <span class="at">d=</span><span class="dv">2</span>), <span class="st">&quot;%&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb159-8"><a href="capítulo-5.html#cb159-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb159-9"><a href="capítulo-5.html#cb159-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;1 privaciones = 86.75%&quot;
## [1] &quot;2 privaciones = 73.02%&quot;
## [1] &quot;3 privaciones = 56.6%&quot;
## [1] &quot;4 privaciones = 37.67%&quot;
## [1] &quot;5 privaciones = 19.2%&quot;
## [1] &quot;6 privaciones = 4.51%&quot;</code></pre>
<p>
 
</p>
</div>
<div id="indice-bourguignon-y-chakravarty-bc---pobreza-multidimensional" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Indice Bourguignon y Chakravarty (BC) - Pobreza Multidimensional</h2>
<p>###- (pág. 335-336)</p>
<p>El código a continuación permite reproducir el cuadro 5.2 del texto sobre pobreza multidimensional computada con el índice de Bourguignon y Chakravarty (BC). El cómputo de dicho índice se realiza empleando solo las observaciones que tienen información para las tres dimensiones consideradas en el texto; por lo que se eliminan las observaciones con missing en al menos una de esas dimensiones. Se eligen los valores para los parametros relevantes y se fija el número de dimensiones a considerar</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="capítulo-5.html#cb161-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ipcf), <span class="sc">!</span><span class="fu">is.na</span>(aedu_avg), <span class="sc">!</span><span class="fu">is.na</span>(rat_miembros_cuartos))</span>
<span id="cb161-2"><a href="capítulo-5.html#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="capítulo-5.html#cb161-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="dv">1</span>  </span>
<span id="cb161-4"><a href="capítulo-5.html#cb161-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb161-5"><a href="capítulo-5.html#cb161-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-6"><a href="capítulo-5.html#cb161-6" aria-hidden="true" tabindex="-1"></a>dim_t<span class="ot">=</span><span class="dv">3</span>    <span class="co">#total dimensiones</span></span></code></pre></div>
<p>Posteriormente almacenamos los valores de las observacion en una lista, donde cada elemento contiene todos los valores de cada una de las 3 variables a considerar. En vectores separados almacenamos los umbrales y los pesos</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="capítulo-5.html#cb162-1" aria-hidden="true" tabindex="-1"></a>dimension <span class="ot">&lt;-</span> <span class="fu">list</span>( df<span class="sc">$</span>ipcf,                  <span class="co"># (1) ipcf </span></span>
<span id="cb162-2"><a href="capítulo-5.html#cb162-2" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span><span class="sc">/</span>df<span class="sc">$</span>rat_miembros_cuartos,      <span class="co"># (2) ratio de miembros por cuarto</span></span>
<span id="cb162-3"><a href="capítulo-5.html#cb162-3" aria-hidden="true" tabindex="-1"></a>             df<span class="sc">$</span>aedu_avg                     <span class="co"># (3) educación promedio de jefe y conyuge</span></span>
<span id="cb162-4"><a href="capítulo-5.html#cb162-4" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb162-5"><a href="capítulo-5.html#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="capítulo-5.html#cb162-6" aria-hidden="true" tabindex="-1"></a>umbral <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">564.119195</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">7</span>)   <span class="co">#valores para los umbrales de cada dimensiones</span></span>
<span id="cb162-7"><a href="capítulo-5.html#cb162-7" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)                  <span class="co">#wt correspondiente</span></span></code></pre></div>
<p>El objeto brechas se define como vacío y cada uno de sus elementos se genera en las iteraciones sucesivas del bucle al comparar cada valor de la variable contra los umbrales fijados. El objeto “suma_brechas” se crea como un vector único con valores 0, y luego se reemplaza iterativamente para computar la suma de brechas. El bucle itera <em>n</em> veces en total, siendo <em>n</em> la cantidad de dimensiones relevadas. En cada iteracion replica la formula de BC para cada dimensión.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="capítulo-5.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#defino la lista brechas como vacia para generar cada uno de sus elementos en el bucle</span></span>
<span id="cb163-2"><a href="capítulo-5.html#cb163-2" aria-hidden="true" tabindex="-1"></a>brecha <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb163-3"><a href="capítulo-5.html#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="capítulo-5.html#cb163-4" aria-hidden="true" tabindex="-1"></a>suma_brechas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(df)))</span>
<span id="cb163-5"><a href="capítulo-5.html#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="capítulo-5.html#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>dim_t) {</span>
<span id="cb163-7"><a href="capítulo-5.html#cb163-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-8"><a href="capítulo-5.html#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generar brechas a partir de valores de las dimensiones vs umbrales</span></span>
<span id="cb163-9"><a href="capítulo-5.html#cb163-9" aria-hidden="true" tabindex="-1"></a>  brecha[[i]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dimension[[i]]<span class="sc">&lt;</span>umbral[i], <span class="dv">1</span><span class="sc">-</span>dimension[[i]]<span class="sc">/</span>umbral[i], <span class="dv">0</span>)</span>
<span id="cb163-10"><a href="capítulo-5.html#cb163-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-11"><a href="capítulo-5.html#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#construir brechas ponderadas</span></span>
<span id="cb163-12"><a href="capítulo-5.html#cb163-12" aria-hidden="true" tabindex="-1"></a>  brecha[[i]] <span class="ot">&lt;-</span> wt[i]<span class="sc">/</span>dim_t <span class="sc">*</span> (brecha[[i]]<span class="sc">^</span>theta)</span>
<span id="cb163-13"><a href="capítulo-5.html#cb163-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-14"><a href="capítulo-5.html#cb163-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#computar suma de las brechas. Suma_brechas será = 0 solo si todas las brechas son 0</span></span>
<span id="cb163-15"><a href="capítulo-5.html#cb163-15" aria-hidden="true" tabindex="-1"></a>  suma_brechas <span class="ot">=</span> suma_brechas <span class="sc">+</span> brecha[[i]]</span>
<span id="cb163-16"><a href="capítulo-5.html#cb163-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-17"><a href="capítulo-5.html#cb163-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Finalmente se calcula, para cada individuo, la suma de las brechas ponderadas elevadas a la potencia <em>theta</em>, siempre que la suma de las brechas sea distinta de cero. Por último, se computa el índice BC como el cociente entre la suma ponderada de las brechas individuales almacenadas en la variable suma_brechas y la población de referencia.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="capítulo-5.html#cb164-1" aria-hidden="true" tabindex="-1"></a>suma_brechas <span class="ot">=</span> <span class="fu">ifelse</span>(suma_brechas<span class="sc">!=</span><span class="dv">0</span>, suma_brechas<span class="sc">^</span>(alpha<span class="sc">/</span>theta), suma_brechas)</span>
<span id="cb164-2"><a href="capítulo-5.html#cb164-2" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb164-3"><a href="capítulo-5.html#cb164-3" aria-hidden="true" tabindex="-1"></a>BC <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(suma_brechas<span class="sc">*</span>df<span class="sc">$</span>pondera)<span class="sc">/</span><span class="fu">sum</span>(df<span class="sc">$</span>pondera), <span class="at">d=</span><span class="dv">3</span>)</span>
<span id="cb164-4"><a href="capítulo-5.html#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="capítulo-5.html#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;BC =&quot;</span>, BC))</span></code></pre></div>
<pre><code>## [1] &quot;BC = 0.08&quot;</code></pre>
<p>
 
</p>
</div>
<div id="indice-alkire-y-foster-af---pobreza-multidimensional" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Indice Alkire y Foster (AF) - Pobreza Multidimensional</h2>
<p>###- (pág. 337-338)</p>
<p>A continuación se replica la formula de Alkire y Foster que permite replicar el cuadro 5.3 del texto. Las primeras lineas son identicas al caso anterior, cambiando los parametros de interés y agregando la lista “pobre” como objeto vacío.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="capítulo-5.html#cb166-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb166-2"><a href="capítulo-5.html#cb166-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb166-3"><a href="capítulo-5.html#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="capítulo-5.html#cb166-4" aria-hidden="true" tabindex="-1"></a>dim_t<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb166-5"><a href="capítulo-5.html#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="capítulo-5.html#cb166-6" aria-hidden="true" tabindex="-1"></a>dim <span class="ot">&lt;-</span> <span class="fu">list</span>( df<span class="sc">$</span>ipcf,                       </span>
<span id="cb166-7"><a href="capítulo-5.html#cb166-7" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span><span class="sc">/</span>df<span class="sc">$</span>rat_miembros_cuartos,      </span>
<span id="cb166-8"><a href="capítulo-5.html#cb166-8" aria-hidden="true" tabindex="-1"></a>             df<span class="sc">$</span>aedu_avg                     </span>
<span id="cb166-9"><a href="capítulo-5.html#cb166-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb166-10"><a href="capítulo-5.html#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="capítulo-5.html#cb166-11" aria-hidden="true" tabindex="-1"></a>umbral <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">564.119195</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb166-12"><a href="capítulo-5.html#cb166-12" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb166-13"><a href="capítulo-5.html#cb166-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-14"><a href="capítulo-5.html#cb166-14" aria-hidden="true" tabindex="-1"></a><span class="co">#defino la lista &quot;brechas&quot; Y pobre como vacia para generar cada uno de sus elementos en el bucle</span></span>
<span id="cb166-15"><a href="capítulo-5.html#cb166-15" aria-hidden="true" tabindex="-1"></a>brecha <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb166-16"><a href="capítulo-5.html#cb166-16" aria-hidden="true" tabindex="-1"></a>pobre <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code></pre></div>
<p>Nuevamente el bucle itera sobre las <em>n</em> dimensiones fijada generando los valores de brecha para cada observación y ahora también completando el objeto binario “pobre” según el valor que toma la brecha. Al finalizar el bucle se construye el objeto “npriv” que contiene el número de dimensiones en que cada individuo fue identificado como pobre (vale cero para los individuos no pobres). El objeto “pobre_k” vale 1 para los individuos que son pobres en, al menos, k dimensiones.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="capítulo-5.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>dim_t) {</span>
<span id="cb167-2"><a href="capítulo-5.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-3"><a href="capítulo-5.html#cb167-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generar brechas a partir de valores de las dimensiones vs umbrales</span></span>
<span id="cb167-4"><a href="capítulo-5.html#cb167-4" aria-hidden="true" tabindex="-1"></a>    brecha[[i]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dim[[i]]<span class="sc">&lt;</span>umbral[i], (<span class="dv">1</span><span class="sc">-</span>dim[[i]]<span class="sc">/</span>umbral[i])<span class="sc">^</span>alpha, <span class="dv">0</span>)</span>
<span id="cb167-5"><a href="capítulo-5.html#cb167-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-6"><a href="capítulo-5.html#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#identificar si es pobre en dimensión i</span></span>
<span id="cb167-7"><a href="capítulo-5.html#cb167-7" aria-hidden="true" tabindex="-1"></a>    pobre[[i]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(brecha[[i]]<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb167-8"><a href="capítulo-5.html#cb167-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-9"><a href="capítulo-5.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-10"><a href="capítulo-5.html#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="capítulo-5.html#cb167-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-12"><a href="capítulo-5.html#cb167-12" aria-hidden="true" tabindex="-1"></a><span class="co">#identificar pobres en al menos k dimensiones</span></span>
<span id="cb167-13"><a href="capítulo-5.html#cb167-13" aria-hidden="true" tabindex="-1"></a>npriv <span class="ot">=</span> pobre[[<span class="dv">1</span>]] <span class="sc">+</span> pobre[[<span class="dv">2</span>]] <span class="sc">+</span> pobre[[<span class="dv">3</span>]]</span>
<span id="cb167-14"><a href="capítulo-5.html#cb167-14" aria-hidden="true" tabindex="-1"></a>pobre_k <span class="ot">=</span> <span class="fu">ifelse</span>(npriv<span class="sc">&gt;=</span>k, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>La línea siguiente genera la variable “suma_brechas” que, como antes, se emplea luego para almacenar la suma de las brechas en cada una de las dimensiones consideradas. El bucle constuye para cada dimensión los objetos necesarios para replicar la formula de AK</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="capítulo-5.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>dim_t) {  </span>
<span id="cb168-2"><a href="capítulo-5.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb168-3"><a href="capítulo-5.html#cb168-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#brechas positivas solo si el número de privaciones mayor a k</span></span>
<span id="cb168-4"><a href="capítulo-5.html#cb168-4" aria-hidden="true" tabindex="-1"></a>    brecha[[i]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pobre_k<span class="sc">!=</span><span class="dv">1</span>, <span class="dv">0</span>, brecha[[i]])</span>
<span id="cb168-5"><a href="capítulo-5.html#cb168-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb168-6"><a href="capítulo-5.html#cb168-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#construir brechas ponderadas</span></span>
<span id="cb168-7"><a href="capítulo-5.html#cb168-7" aria-hidden="true" tabindex="-1"></a>    brecha[[i]] <span class="ot">&lt;-</span> wt[i] <span class="sc">*</span> brecha[[i]]</span>
<span id="cb168-8"><a href="capítulo-5.html#cb168-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb168-9"><a href="capítulo-5.html#cb168-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#computar suma de las brechas. Suma_brechas será = 0 solo si todas las brechas son 0</span></span>
<span id="cb168-10"><a href="capítulo-5.html#cb168-10" aria-hidden="true" tabindex="-1"></a>    suma_brechas <span class="ot">=</span> suma_brechas <span class="sc">+</span> brecha[[i]]</span>
<span id="cb168-11"><a href="capítulo-5.html#cb168-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb168-12"><a href="capítulo-5.html#cb168-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Por último se computa y se redondean los valores del índice de AF</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="capítulo-5.html#cb169-1" aria-hidden="true" tabindex="-1"></a>AK <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(suma_brechas<span class="sc">*</span>df<span class="sc">$</span>pondera)<span class="sc">/</span>(dim_t<span class="sc">*</span><span class="fu">sum</span>(df<span class="sc">$</span>pondera)), <span class="at">d=</span><span class="dv">5</span>)</span>
<span id="cb169-2"><a href="capítulo-5.html#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="capítulo-5.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;AK =&quot;</span>, AK))</span></code></pre></div>
<pre><code>## [1] &quot;AK = 0.12319&quot;</code></pre>
<p>
 
</p>
</div>
<div id="perfiles-de-pobreza" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Perfiles de Pobreza</h2>
<p>###- (pág. 338-339)</p>
<p>El bloque de código a continuación puede emplearse para computar el perfil de pobreza monetaria para vivienda y servicios que se muestra en el cuadro 5.8. El código del ejemplo se aplica a la EPH (Encuesta Permanente de Hogares) de Paraguay para el año 2007. Luego de cargar y definir la base, la tercer linea de código genera la variable “hh” que vale 1 para una única observación de cada hogar, a partir de indentificar las observaciones duplicadas. El comando <code>duplicated</code> asigna valor <code>FALSE</code> a la primera observación del por hogar, y <code>TRUE</code> a todo el resto.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="capítulo-5.html#cb171-1" aria-hidden="true" tabindex="-1"></a>pry07 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Par/2007/bases/par07_cedlas.dta&quot;</span>)</span>
<span id="cb171-2"><a href="capítulo-5.html#cb171-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> pry07</span>
<span id="cb171-3"><a href="capítulo-5.html#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="capítulo-5.html#cb171-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>hh <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">duplicated</span>(df<span class="sc">$</span>id)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<p>Luego generamos en el data frame la variable indicativa de pobreza monetaria y a partir de ella computamos para el grupo de pobres y no pobres, el promedio de las variables “habita,” “matpreca,” “agua,” “banio” y “elect,” indicado la proporción de personas que cuenta con estos servicios.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="capítulo-5.html#cb172-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>pobre <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>ipcf<span class="sc">&lt;</span><span class="fl">205970.366</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb172-2"><a href="capítulo-5.html#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="capítulo-5.html#cb172-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hh<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pobre)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pobre) <span class="sc">%&gt;%</span>    </span>
<span id="cb172-4"><a href="capítulo-5.html#cb172-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">summarise</span>( <span class="at">mean_habita =</span> <span class="fu">weighted.mean</span>(habita, pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-5"><a href="capítulo-5.html#cb172-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean_matpreca =</span> <span class="fu">weighted.mean</span>(matpreca,pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-6"><a href="capítulo-5.html#cb172-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean_banio =</span> <span class="fu">weighted.mean</span>(banio, pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-7"><a href="capítulo-5.html#cb172-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean_agua =</span> <span class="fu">weighted.mean</span>(agua, pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-8"><a href="capítulo-5.html#cb172-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean_elect =</span> <span class="fu">weighted.mean</span>(elect, pondera, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   pobre mean_habita mean_matpreca mean_banio mean_agua mean_elect
##   &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1     0        3.36        0.0108      0.761     0.975      0.978
## 2     1        2.53        0.0414      0.364     0.905      0.898</code></pre>
<p>Con el comando <code>ttest</code> buscamos evaluar la significatividad estadística de estas diferencias de medias entre pobres y no pobres para las variables incluidas. Para esto elegimos el nivel de confianza y definimos un bucle que itera sobre cada variable respectiva del data frame. Dentro de él construimos un objeto “x” que contiene los valores para estas variables sólo para una única observación por hogar y para el grupo de pobres y otro objeto “y” con los mismos datos para el grupo de no pobres. A partir de estos objetos se evaluan las significatividad de la diferencia de medias entre ambos grupos y se reporta si su p-valor es mayor al nivel de confianza fijado.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="capítulo-5.html#cb174-1" aria-hidden="true" tabindex="-1"></a>set_confidence <span class="ot">=</span> <span class="dv">95</span> </span>
<span id="cb174-2"><a href="capítulo-5.html#cb174-2" aria-hidden="true" tabindex="-1"></a>confidence <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> set_confidence<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb174-3"><a href="capítulo-5.html#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="capítulo-5.html#cb174-4" aria-hidden="true" tabindex="-1"></a>dim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;habita&quot;</span>, <span class="st">&quot;matpreca&quot;</span>, <span class="st">&quot;banio&quot;</span>, <span class="st">&quot;agua&quot;</span>, <span class="st">&quot;elect&quot;</span>)</span>
<span id="cb174-5"><a href="capítulo-5.html#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> dim){</span>
<span id="cb174-6"><a href="capítulo-5.html#cb174-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb174-7"><a href="capítulo-5.html#cb174-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb174-8"><a href="capítulo-5.html#cb174-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> df[df<span class="sc">$</span>pobre<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> df<span class="sc">$</span>hh<span class="sc">==</span><span class="dv">1</span>, <span class="fu">colnames</span>(df)<span class="sc">==</span>i]</span>
<span id="cb174-9"><a href="capítulo-5.html#cb174-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> df[df<span class="sc">$</span>pobre<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> df<span class="sc">$</span>hh<span class="sc">==</span><span class="dv">1</span>, <span class="fu">colnames</span>(df)<span class="sc">==</span>i]</span>
<span id="cb174-10"><a href="capítulo-5.html#cb174-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb174-11"><a href="capítulo-5.html#cb174-11" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">=</span> <span class="fu">t.test</span>(x,y)</span>
<span id="cb174-12"><a href="capítulo-5.html#cb174-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;No significative mean diff:&quot;</span>, test<span class="sc">$</span>p.value <span class="sc">&gt;</span> confidence))</span>
<span id="cb174-13"><a href="capítulo-5.html#cb174-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-14"><a href="capítulo-5.html#cb174-14" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<pre><code>## [1] &quot;habita&quot;
## [1] &quot;No significative mean diff: FALSE&quot;
## [1] &quot;matpreca&quot;
## [1] &quot;No significative mean diff: FALSE&quot;
## [1] &quot;banio&quot;
## [1] &quot;No significative mean diff: FALSE&quot;
## [1] &quot;agua&quot;
## [1] &quot;No significative mean diff: FALSE&quot;
## [1] &quot;elect&quot;
## [1] &quot;No significative mean diff: FALSE&quot;</code></pre>
<p>
 
</p>
</div>
<div id="perfiles-de-pobreza-condicionados" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Perfiles de Pobreza Condicionados</h2>
<p>###- (pág. 340-341)</p>
<p>El bloque de código siguiente permite replicar el cuadro 5.12, que muestra perfiles condicionados de pobreza. En el ejemplo se emplea la encuesta de México para el año 2006.
Luego de cargar la base eliminamos las observaciones incohrentes y al igual que antes generamos la variable indicativa de pobreza monetaria línea de 2.5 dólares. Las lineas siguientes agregan nuevas variables al data frame que suman la cantidad de individuos que pertenecen a distintos grupos etarios dentro de cada hogar, calculan el ratio de miembros por habitaciones y los valores de educación y edad al cuadrado</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="capítulo-5.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cargo base </span></span>
<span id="cb176-2"><a href="capítulo-5.html#cb176-2" aria-hidden="true" tabindex="-1"></a>mex06 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(data_dir <span class="sc">%+%</span> <span class="st">&quot;Mex/2006/bases/mex06_cedlas.dta&quot;</span>)      </span>
<span id="cb176-3"><a href="capítulo-5.html#cb176-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mex06</span>
<span id="cb176-4"><a href="capítulo-5.html#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="capítulo-5.html#cb176-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cohh<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb176-6"><a href="capítulo-5.html#cb176-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>pobre <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>ipcf<span class="sc">&lt;</span><span class="fl">608.24533</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb176-7"><a href="capítulo-5.html#cb176-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-8"><a href="capítulo-5.html#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="co">#número de miembros en cada grupo</span></span>
<span id="cb176-9"><a href="capítulo-5.html#cb176-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(id) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb176-10"><a href="capítulo-5.html#cb176-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>( <span class="at">miembros_edad_0015 =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(edad<span class="sc">&lt;=</span><span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb176-11"><a href="capítulo-5.html#cb176-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miembros_edad_1625 =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(edad <span class="sc">%in%</span> (<span class="dv">16</span><span class="sc">:</span><span class="dv">25</span>), <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb176-12"><a href="capítulo-5.html#cb176-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miembros_edad_2640 =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(edad <span class="sc">%in%</span> (<span class="dv">26</span><span class="sc">:</span><span class="dv">40</span>), <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb176-13"><a href="capítulo-5.html#cb176-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miembros_edad_4160 =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(edad <span class="sc">%in%</span> (<span class="dv">41</span><span class="sc">:</span><span class="dv">64</span>), <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb176-14"><a href="capítulo-5.html#cb176-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">miembros_edad_65mas=</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(edad<span class="sc">&gt;=</span><span class="dv">65</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb176-15"><a href="capítulo-5.html#cb176-15" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb176-16"><a href="capítulo-5.html#cb176-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rat_miembros_cuartos =</span> miembros<span class="sc">/</span>habita,</span>
<span id="cb176-17"><a href="capítulo-5.html#cb176-17" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb176-18"><a href="capítulo-5.html#cb176-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">aedu2=</span>aedu<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb176-19"><a href="capítulo-5.html#cb176-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">edad2=</span>edad<span class="sc">^</span><span class="dv">2</span> )</span></code></pre></div>
<p>Las líneas siguientes contienen la sentencia que estima, para los jefes de hogar, el modelo probit para la probabilidad de ser pobre. Para ello empleamos el comando <code>glm</code> en el cual definimos la variable independiente y todo el conjunto de regresores, indicamos el data frame referido y la familia de modelos que buscamos estimar. Esta estimación la guardamos en el objeto “probit” que luego visualizamos con un <code>summary</code></p>
<p>Para computar los efectos marginales para el rango 0 a 22 años de educación del jefe de hogar, empleamos el comando <code>margins</code>. Para ello indicamos donde almacenamos nuestra estimación (objeto probit), para qué variables deseamos calcular los efectos (aedu) y sobre qué valores evaluarlos (0:22).</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="capítulo-5.html#cb177-1" aria-hidden="true" tabindex="-1"></a>store <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">margins</span>(probit, <span class="at">variables =</span> <span class="st">&quot;aedu&quot;</span>, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">aedu =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">22</span>)))</span>
<span id="cb177-2"><a href="capítulo-5.html#cb177-2" aria-hidden="true" tabindex="-1"></a>store</span></code></pre></div>
<pre><code>##  factor    aedu     AME     SE        z      p   lower   upper
##    aedu  0.0000 -0.0165 0.0029  -5.6272 0.0000 -0.0222 -0.0107
##    aedu  1.0000 -0.0158 0.0028  -5.7352 0.0000 -0.0212 -0.0104
##    aedu  2.0000 -0.0151 0.0026  -5.8741 0.0000 -0.0202 -0.0101
##    aedu  3.0000 -0.0145 0.0024  -6.0478 0.0000 -0.0191 -0.0098
##    aedu  4.0000 -0.0138 0.0022  -6.2616 0.0000 -0.0181 -0.0095
##    aedu  5.0000 -0.0131 0.0020  -6.5223 0.0000 -0.0170 -0.0092
##    aedu  6.0000 -0.0124 0.0018  -6.8395 0.0000 -0.0160 -0.0088
##    aedu  7.0000 -0.0117 0.0016  -7.2263 0.0000 -0.0149 -0.0085
##    aedu  8.0000 -0.0111 0.0014  -7.7006 0.0000 -0.0139 -0.0082
##    aedu  9.0000 -0.0104 0.0013  -8.2882 0.0000 -0.0129 -0.0079
##    aedu 10.0000 -0.0098 0.0011  -9.0270 0.0000 -0.0119 -0.0076
##    aedu 11.0000 -0.0091 0.0009  -9.9743 0.0000 -0.0109 -0.0074
##    aedu 12.0000 -0.0085 0.0008 -11.2219 0.0000 -0.0100 -0.0071
##    aedu 13.0000 -0.0080 0.0006 -12.9242 0.0000 -0.0092 -0.0068
##    aedu 14.0000 -0.0074 0.0005 -15.3614 0.0000 -0.0084 -0.0065
##    aedu 15.0000 -0.0069 0.0004 -19.0911 0.0000 -0.0076 -0.0062
##    aedu 16.0000 -0.0064 0.0003 -25.3519 0.0000 -0.0069 -0.0059
##    aedu 17.0000 -0.0059 0.0002 -37.0835 0.0000 -0.0062 -0.0056
##    aedu 18.0000 -0.0054 0.0001 -56.6339 0.0000 -0.0056 -0.0052
##    aedu 19.0000 -0.0050 0.0001 -52.3155 0.0000 -0.0052 -0.0048
##    aedu 20.0000 -0.0046 0.0001 -32.5281 0.0000 -0.0048 -0.0043
##    aedu 21.0000 -0.0042 0.0002 -21.7719 0.0000 -0.0046 -0.0038
##    aedu 22.0000 -0.0038 0.0002 -15.9736 0.0000 -0.0043 -0.0034</code></pre>
<p>Esta información la guardamos en un objeto llamado “store,” del cual nos interesa recuperar el valor de los coficientes almacenados bajo el nombre AME (Average Mean Effect). Con ellos generamos un vector “y” que denota los efectos para cada valor de años de educación, los cuale guardamos en el vector “x.” Finalmente graficamos la relación.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="capítulo-5.html#cb179-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> store<span class="sc">$</span>AME</span>
<span id="cb179-2"><a href="capítulo-5.html#cb179-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">22</span>)</span>
<span id="cb179-3"><a href="capítulo-5.html#cb179-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-4"><a href="capítulo-5.html#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y,</span>
<span id="cb179-5"><a href="capítulo-5.html#cb179-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Efecto Marginal&quot;</span>,</span>
<span id="cb179-6"><a href="capítulo-5.html#cb179-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Años Educación&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>Una forma más directa de graficar los efectos marginales es a partir del comando <code>cplot</code> de la familia margins, que estima automaticamente estos mismos valores a partir de la estimación del modelo probit</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="capítulo-5.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cplot(probit, &quot;aedu&quot;, what = &quot;effect&quot;, main = &quot;Average Marginal Effect of Weight&quot;)</span></span></code></pre></div>

</div>
</div>









            </section>

          </div>
        </div>
      </div>
<a href="capítulo-4.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Cap5_html.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
